<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
    
<struts>
	<package name="vulnerability" extends="struts-default" namespace="/vulnerability">
		<action name="query" class="VulnerabilityAction" method="queryVulnerability">
			<result name="success">/pages/vulnerability/vulnerability_list.jsp</result>     	
		</action>
		
		<action name="editVulnerability" class="VulnerabilityAction" method="editVulnerability">
			<result name="success">/pages/vulnerability/vulnerability_info.jsp</result>    
		</action>
		
		
		<action name="updateVulnerability" class="VulnerabilityAction" method="updateVulnerability">
		    <result name="success" type="chain">
		    	<param name="namespace">/vulnerability</param>
		    	<param name="actionName">query</param>
		    </result>
		</action>
		
		<action name="deleteVulnerability" class="VulnerabilityAction" method="deleteVulnerability">
			<result name="success" type="chain">
		    	<param name="namespace">/vulnerability</param>
		    	<param name="actionName">query</param>
		    </result>    	
		</action>
		<action name="checkExport" class="VulnerabilityAction" method="checkExport">
			<result name="success" type="chain">
		    	<param name="namespace">/vulnerability</param>
		    	<param name="actionName">query</param>
		    </result>    	
		</action>
		<action name="importVulnerability" class="VulnerabilityAction" method="importVulnerability">
			<result name="success" type="chain">
                <param name="actionName">query</param>
				<param name="namespace">/vulnerability</param>
				<param name="field">${field}</param>
            </result>     	
		</action>
		
		<!--显示升级页面 -->
		<action name="showSettingUpdate" class="VulnerabilityAction" method="showSettingUpdate">
		    <result name="success">/pages/vulnerability/vulnerability_upgrade.jsp</result>
		</action>
		
		<action name="settingUpdate" class="VulnerabilityAction" method="settingUpdate">
			<!-- <result name="success">/pages/systemsetting/setting_update.jsp</result> -->
		</action>
		
		<action name="showUpdatePercent" class="VulnerabilityAction" method="showUpdatePercent">
		</action>
		
		<action name="UpTar" class="VulnerabilityAction" method="uptar">
		   <result name="success" type="chain">
		     <param name="namespace">/vulnerability</param>
		     <param name="actionName">showSettingUpdate</param>
		     <param name="upStatr">${upStatr}</param>
		     <param name="ids">${ids}</param>
		     <param name="upTarFileName">${upTarFileName}</param>
		   </result>
		</action>
		
		<action name="sort" class="VulnerabilityAction" method="sort">
		   			<result name="success">/pages/vulnerability/vulnerability_list.jsp</result>    
		</action>
		<!-- 显示左侧事件树  -->
		<action name="queryTreeAction" class="eventTreeAction"
			method="queryTree">
			<result name="success">/pages/vulnerability/knowledge_menu.jsp</result>
		</action>
		<!-- 显示左侧事件树对应库   -->
		<action name="queryEventLibraryList" class="eventLibraryAction"
			method="queryList">
			<result name="success">/pages/vulnerability/event_library_list.jsp</result>
			<result name="detail">/pages/vulnerability/event_library_list_detail.jsp</result>
		</action>
		<action name="deleteEventLibraryList" class="eventLibraryAction"
			method="deleteLibrary">
			<result name="success">/pages/vulnerability/event_library_list.jsp</result>
		</action>
		
		<action name="saveEventLibraryList" class="eventLibraryAction"
			method="saveLibrary" >
			<result name="success">/pages/vulnerability/event_library_list.jsp</result>
		</action>
		
		<action name="checkEventLibrary" class="eventLibraryAction" method="checkEventLibrary" >
		</action>
	
	</package>
</struts>	