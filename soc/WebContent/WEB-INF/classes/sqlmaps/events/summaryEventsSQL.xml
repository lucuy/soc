<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="summaryEventsSQL">
<resultMap id="eventsLogResult" class="events">
		<result property="eventsId" column="LOG_ID" />
		<result property="name" column="LOG_NAME" />
		<result property="aggregatedCount" column="LOG_AGGREGATED_COUNT" />
		<result property="systype" column="LOG_SYSTYPE" />
		<result property="collectType" column="LOG_COLLECTTYPE" />
		<result property="sensorAddr" column="LOG_SENSORADDR" />
		<result property="sensorName" column="LOG_SENSORNAME" />
		<result property="collectorAddr" column="LOG_COLLECTORADDR" />
		<result property="collectorName" column="LOG_COLLECTORNAME" />
		<result property="cateGory" column="LOG_CATEGORY" />
		<result property="type" column="LOG_TYPE" />
		<result property="priority" column="LOG_PRIORITY" />
		<result property="oriPriority" column="LOG_ORIPRIORITY" />
		<result property="rawId" column="LOG_RAWID" />
		<result property="duration" column="LOG_DURATION" />
		<result property="send" column="LOG_SEND" />
		<result property="receive" column="LOG_RECEIVE" />
		<result property="protocol" column="LOG_PROTOCOL" />
		<result property="object" column="LOG_OBJECT" />
		<result property="policy" column="LOG_POLICY" />
		<result property="resource" column="LOG_RESOURCE" />
		<result property="action" column="LOG_ACTION" />
		<result property="intent" column="LOG_INTENT" />
		<result property="result" column="LOG_RESULT" />
		<result property="sAddr" column="LOG_SADDR" />
		<result property="sName" column="LOG_SNAME" />
		<result property="sPort" column="LOG_SPORT" />
		<result property="sprocess" column="LOG_SPROCESS" />
		<result property="suserId" column="LOG_SUSERID" />
		<result property="suserName" column="LOG_SUSERNAME" />
		<result property="sTAddr" column="LOG_STADDR" />
		<result property="sTPort" column="LOG_STPORT" />
		<result property="dAddr" column="LOG_DADDR" />
		<result property="dName" column="LOG_DNAME" />
		<result property="dPort" column="LOG_DPORT" />
		<result property="dProcess" column="LOG_DPROCESS" />
		<result property="dUserId" column="LOG_DUSERID" />
		<result property="dUserName" column="LOG_DUSERNAME" />
		<result property="dTAddr" column="LOG_DTADDR" />
		<result property="dTPort" column="LOG_DTPORT" />
		<result property="devAdd" column="LOG_DEVADDR" />
		<result property="devName" column="LOG_DEVNAME" />
		<result property="devCategory" column="LOG_DEVCATEGORY" />
		<result property="devType" column="LOG_DEVTYPE" />
		<result property="devVendor" column="LOG_DEVVENDOR" />
		<result property="programType" column="LOG_PROGRAMTYPE" />
		<result property="program" column="LOG_PROGRAM" />
		<result property="customs1" column="LOG_CUSTOMS1" />
		<result property="customs2" column="LOG_CUSTOMS2" />
		<result property="customs3" column="LOG_CUSTOMS3" />
		<result property="customs4" column="LOG_CUSTOMS4" />
		<result property="customd1" column="LOG_CUSTOMD1" />
		<result property="customd2" column="CUSTOMD2" />
		<result property="devproduct" column="LOG_DEVPRODUCT" />
		<result property="sessionId" column="LOG_SESSIONID" />
		<result property="customs5" column="LOG_CUSTOMS5" />
		<result property="customs6" column="LOG_SUSTOMS6" />
		<result property="customs7" column="CUSTOMS7" />
		<result property="customd3" column="CUSTOMD3" />
		<result property="customd4" column="CUSTOMD4" />
		<result property="requesturi" column="LOG_REQUESTURI" />
		<result property="msg" column="LOG_MSG" />
		<result property="sendTime" column="LOG_SENDTIME" />
		<result property="receptTime" column="LOG_RECEPT_TIME" />
		<result property="identification" column="LOG_IDENTIFICATION" />
		<result property="appProtocol" column="LOG_APPPROTOCOL" />
		<result property="originLog" column="LOG_IDENTIFICATION"
			select="pgAdminquery.originLog" />
		<result property="assetId" column="LOG_ASSET_ID" />
	</resultMap>
	<resultMap id="summaryEventsResult" class="summaryEvents">
		<result property="eventsId" column="EVENTS_ID" jdbcType="bigint" />
		<result property="eventsLevel" column="EVENTS_LEVEL" jdbcType="int" />
		<result property="eventsName" column="EVENTS_NAME" jdbcType="varchar" />
		<result property="eventsSourceAdd" column="EVENTS_SOURCEADD"
			jdbcType="bigint" />
		<result property="eventsSourcePort" column="EVENTS_SOURCEPORT"
			jdbcType="int" />
		<result property="eventsTargetAdd" column="EVENTS_TARGETADD"
			jdbcType="bigint" />
		<result property="eventsTargetPort" column="EVENTS_TARGETPORT"
			jdbcType="int" />
		<result property="eventsNumber" column="EVENTS_NUMBER"
			jdbcType="int" />
		<result property="eventsSource" column="EVENTS_SOURCE"
			jdbcType="varchar" />
		<result property="eventsTime" column="EVENTS_BEGINTIME"
			jdbcType="datetime" />
		<result property="eventsType" column="EVENTS_TYPE" jdbcType="varchar" />
		<result property="eventsTableType" column="EVENTS_TABLE_TYPE"
			jdbcType="int" />
		<result property="eventsSourceAddT" column="EVENTS_SOURCEADDT"
			jdbcType="int" />
		<result property="eventsTargetAddT" column="EVENTS_TARGETADDT"
			jdbcType="int" />
		<result property="eventsPutTime" column="EVENTS_PUTTIME"
			jdbcType="bigint" />
		<result property="eventsLogIdentification" column="EVENTS_LOG_IDENTIFICATION"
			jdbcType="varchar" />
		<result property="eventsDevProduct" column="EVENTS_DEVPRODUCT"
			jdbcType="varchar" />
		<result property="eventsProgram" column="EVENTS_PROGRAM"
			jdbcType="varchar" />
		<result property="eventsDevType" column="EVENTS_DEVTYPE"
			jdbcType="varchar" />
		<result property="eventsDevvendor" column="EVENTS_DEVVENDOR"
			jdbcType="varchar" />
		<result property="eventsDevName" column="EVENTS_DEVNAME"
			jdbcType="varchar" />
		<result property="eventsProgramtype" column="EVENTS_PROGRAMTYPE"
			jdbcType="varchar" />
		<result property="eventsCustomd1" column="EVENTS_CUSTOMD1"
			jdbcType="int" />
		<result property="eventsRawid" column="EVENTS_RAWID" jdbcType="int" />
		<result property="assetName" column="REL_ASSET_NAME" jdbcType="varchar" />
		<result property="relLogTableName" column="REL_LOG_TABLE_NAME"
			jdbcType="varchar" />
		<result property="policy" column="EVENTS_POLICY" jdbcType="varchar" />
		<result property="assetId" column="REL_ASSET_ID" jdbcType="int"/>
	</resultMap>
	<!--vpn事件 -->
	<insert id="pgAdmininsert.vpn_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_vpn_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY"
		,"REL_ASSET_ID"
		)
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>



	<!--终端安全事件 -->
	<insert id="pgAdmininsert.terminal_security_events" parameterClass="summaryEvents">
		INSERT INTO tbl_terminal_security_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>
	
	<!--安全设备事件 -->
	<insert id="pgAdmininsert.safety_device_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_safety_device_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!--阻拒绝服务器攻击事件 -->
	<insert id="pgAdmininsert.resistance_refuse_server_attack_events"
		parameterClass="summaryEvents">
		INSERT INTO tbl_resistance_refuse_server_attack_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!--网络设备事件 -->
	<insert id="pgAdmininsert.network_equipment_events" parameterClass="summaryEvents">
		INSERT INTO tbl_network_equipment_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!--负载平衡事件 -->
	<insert id="pgAdmininsert.load_balance_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_load_balance_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!--入侵检测事件 -->
	<insert id="pgAdmininsert.intrusion_detection_events" parameterClass="summaryEvents">
		INSERT INTO tbl_intrusion_detection_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>
	
	<!--入侵防御事件 -->
	<insert id="pgAdmininsert.intrusion_defense_events" parameterClass="summaryEvents">
		INSERT INTO tbl_intrusion_defense_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!--中间事件 -->
	<insert id="pgAdmininsert.intermediate_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_intermediate_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 事件 -->
	<insert id="pgAdmininsert.firewall_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_firewall_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 数据库事件 -->
	<insert id="pgAdmininsert.database_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_database_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 数据库审计产品事件 -->
	<insert id="pgAdmininsert.database_audit_products_events"
		parameterClass="summaryEvents">
		INSERT INTO tbl_database_audit_products_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>
	<!-- 内容过滤网关 -->
	<insert id="pgAdmininsert.content_filtering_gateway_events"
		parameterClass="summaryEvents">
		INSERT INTO tbl_content_filtering_gateway_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 认证系统 -->
	<insert id="pgAdmininsert.authentication_system_events" parameterClass="summaryEvents">
		INSERT INTO tbl_authentication_system_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!-- 应用事件 -->
	<insert id="pgAdmininsert.application_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_application_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- WEB防火墙 -->
	<insert id="pgAdmininsert.antivirus_web_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_antivirus_web_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!--网闸事件 -->
	<insert id="pgAdmininsert.net_brake_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_net_brake_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 防毒系统事件 -->
	<insert id="pgAdmininsert.antivirus_system_events" parameterClass="summaryEvents">
		INSERT INTO tbl_antivirus_system_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 防毒网关事件 -->
	<insert id="pgAdmininsert.antivirus_gateway_events" parameterClass="summaryEvents">
		INSERT INTO tbl_antivirus_gateway_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>


	<!-- 异常流量设备事件 -->
	<insert id="pgAdmininsert.abnormal_flow_device_events" parameterClass="summaryEvents">
		INSERT INTO tbl_abnormal_flow_device_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!-- 插入服务器事件 -->
	<insert id="pgAdmininsert.serverEvents" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>



	<!-- 统计VPN事件总数 -->
	<select id="pgAdminquery_vpn_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_vpn_events" WHERE
		 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		<!-- "tbl_vpn_events" WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_vpn_events" WHERE 1
		= 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>

	<!--VPN事件 -->
	<select id="pgAdminquery.vpn_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_vpn_events" WHERE
		 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_vpn_events"
		WHERE "EVENTS_ID" > ((SELECT
		MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_vpn_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 统计终端安全事件总数 -->
	<select id="pgAdminquery_terminal_security_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_terminal_security_events"
		 WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		<!-- "tbl_terminal_security_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_terminal_security_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--终端安全事件 -->
	<select id="pgAdminquery.terminal_security_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_terminal_security_events"
		 WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_terminal_security_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_terminal_security_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计安全设备事件总数 -->
	<select id="pgAdminquery_safety_device_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_safety_device_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		<!--  "tbl_safety_device_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_safety_device_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" LIKE '$type$'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--安全设备事件 -->
	<select id="pgAdminquery.safety_device_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_safety_device_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ids">
          <![CDATA[
           "EVENTS_ID" in ($ids$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc 
		<!--  "tbl_safety_device_events"
		WHERE "EVENTS_ID"
		> ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_safety_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" LIKE '$type$'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>

	<!-- 统计阻拒绝服务器攻击事件总数 -->
	<select id="pgAdminquery_resistance_refuse_server_attack_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM
		(SELECT * FROM "tbl_resistance_refuse_server_attack_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		 )as temp
		 where 1 = 1 
		<!-- "tbl_resistance_refuse_server_attack_events" WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>



	<!--阻拒绝服务器攻击事件 -->
	<select id="pgAdminquery.resistance_refuse_server_attack_events"
		resultMap="summaryEventsResult" parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_resistance_refuse_server_attack_events"
		 where 1 = 1 
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		 )as temp
		 where 1 = 1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_resistance_refuse_server_attack_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计网络设备事件总数 -->
	<select id="pgAdminquery_network_equipment_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_network_equipment_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		<!-- "tbl_network_equipment_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_network_equipment_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--网络设备事件 -->
	<select id="pgAdminquery.network_equipment_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_network_equipment_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!--"tbl_network_equipment_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		
		"tbl_network_equipment_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>

	<!-- 统计网闸事件总数 -->
	<select id="pgAdminquery_net_brake_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_net_brake_events"
		   where 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		<!-- "tbl_net_brake_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_net_brake_events" WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--网闸事件 -->
	<select id="pgAdminquery.net_brake_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_net_brake_events"
		   where 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- 
		"tbl_net_brake_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_net_brake_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 统计负载平衡事件总数 -->
	<select id="pgAdminquery_load_balance_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_load_balance_events"
		  where 1 = 1
		  <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		<!-- "tbl_load_balance_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_load_balance_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--负载平衡事件 -->
	<select id="pgAdminquery.load_balance_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_load_balance_events"
		  where 1 = 1
		  <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_load_balance_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_load_balance_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计入侵检测事件总数 -->
	<select id="pgAdminquery_intrusion_detection_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_intrusion_detection_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		
		<!-- "tbl_intrusion_detection_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_intrusion_detection_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--入侵检测事件 -->
	<select id="pgAdminquery.intrusion_detection_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_intrusion_detection_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!--  "tbl_intrusion_detection_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_intrusion_detection_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>


	<!-- 统计入侵防御事件总数 -->
	<select id="pgAdminquery_intrusion_defense_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_intrusion_defense_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		<!-- "tbl_intrusion_defense_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_intrusion_defense_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--入侵防御事件 -->
	<select id="pgAdminquery.intrusion_defense_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_intrusion_defense_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!--  "tbl_intrusion_defense_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_intrusion_defense_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>

	<!-- 统计中间事件总数 -->
	<select id="pgAdminquery_intermediate_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_intermediate_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0 
		)as temp
		where 1 = 1
		<!-- "tbl_intermediate_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_intermediate_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->

	</select>



	<!--中间事件 -->
	<select id="pgAdminquery.intermediate_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_intermediate_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0 
		)as temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_intermediate_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_intermediate_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 网神SecGate防火墙总数 -->
	<select id="pgAdminquery_firewall_secgate_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1
		<!--"tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>


	<!-- 网神SecGate防火墙 -->
	<select id="pgAdminquery.firewall_secgate_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 重点攻击防范 总数 -->
	<select id="pgAdminquery_firewall_zdfy_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
			(SELECT * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		<!-- "tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!--重点攻击防范 -->
	<select id="pgAdminquery.firewall_zdfy_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!-- CiscoPIX防火墙 总数 -->
	<select id="pgAdminquery_firewall_ciscopix_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM
		(SELECT * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1 
		<!-- "tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1

		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!--CiscoPIX防火墙 -->
	<select id="pgAdminquery.firewall_ciscopix_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc 
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 统计防火墙事件总数 -->
	<select id="pgAdminquery_firewall_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		
		<!-- "tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--防火墙事件 -->
	<select id="pgAdminquery.firewall_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>


	<!-- 统计数据库事件总数 -->
	<select id="pgAdminquery_database_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_database_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		<!-- "tbl_database_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_database_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--数据库事件 -->
	<select id="pgAdminquery.database_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_database_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		<!--"tbl_database_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_database_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
		order by "EVENTS_BEGINTIME" desc
	</select>


	<!-- 统计数据库审计产品事件总数 -->
	<select id="pgAdminquery_database_audit_products_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_database_audit_products_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1 
		<!-- "tbl_database_audit_products_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_database_audit_products_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--内容数据库审计产品事件 -->
	<select id="pgAdminquery.database_audit_products_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_database_audit_products_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_database_audit_products_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_database_audit_products_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计内容过滤网关事件总数 -->
	<select id="pgAdminquery_content_filtering_gateway_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM <!-- "tbl_content_filtering_gateway_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_content_filtering_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		(
		  SELECT * FROM "tbl_content_filtering_gateway_events" where 1 = 1
		  <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		  </isNotEmpty>
		  order by "EVENTS_ID" desc
		  limit 1000 offset 0
		)as temp
		where 1 = 1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!--内容过滤网关事件 -->
	<select id="pgAdminquery.content_filtering_gateway_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(
		   SELECT * FROM "tbl_content_filtering_gateway_events"
		   where 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		  order by "EVENTS_ID" desc
		  limit 1000 offset 0
		
		
		)as temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		
		<!-- "tbl_content_filtering_gateway_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_content_filtering_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>

	<!-- 统计认证系统事件总数 -->
	<select id="pgAdminquery_authentication_system_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM <!-- "tbl_authentication_system_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_authentication_system_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		(select * from "tbl_authentication_system_events" where 1 =1 
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1 

		

	</select>



	<!--认证系统事件 -->
	<select id="pgAdminquery.authentication_system_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(
		   SELECT * FROM "tbl_authentication_system_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		  order by "EVENTS_ID" desc
		  limit 1000 offset 0
		
		)as temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_authentication_system_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_authentication_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>


	<!-- 统计应用事件总数 -->
	<select id="pgAdminquery_application_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(
		 SELECT * from "tbl_application_events"
		 where 1 =1 
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 =1 
		<!-- "tbl_application_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_application_events" WHERE 1
		= 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!-- 应用事件 -->
	<select id="pgAdminquery.application_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_application_events"
		where 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_application_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_application_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>


	<!-- 统计WEB防火墙事件总数 -->
	<select id="pgAdminquery_antivirus_web_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(
		 SELECT * FROM "tbl_antivirus_web_events" where 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 =1 
		<!-- "tbl_antivirus_web_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_antivirus_web_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!-- WEB防火墙事件 -->
	<select id="pgAdminquery.antivirus_web_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(select * FROM "tbl_antivirus_web_events" where 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1 
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_antivirus_web_events"
		WHERE "EVENTS_ID"
		> ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_antivirus_web_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>



	<!-- 统计防毒系统事件总数 -->
	<select id="pgAdminquery_antivirus_system_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(SELECT * FROM "tbl_antivirus_system_events"
		WHERE 1= 1
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		<!-- "tbl_antivirus_system_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_antivirus_system_events"
		WHERE 1 = 1
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!-- 防毒系统事件 -->
	<select id="pgAdminquery.antivirus_system_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_antivirus_system_events"
		where 1 = 1
        <isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp
		where 1 = 1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		
		<!-- "tbl_antivirus_system_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_antivirus_system_events" WHERE 1=1
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>



	<!-- 统计杀毒网关事件总数 -->
	<select id="pgAdminquery_antivirus_aateway.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(SELECT * FROM "tbl_antivirus_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		<!-- "tbl_antivirus_gateway_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_antivirus_gateway_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>

	<!-- 杀毒网关事件 -->
	<select id="pgAdminquery.antivirus_gateway" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_antivirus_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		)as temp 
		where 1 = 1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_antivirus_gateway_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_antivirus_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>


	<!-- 统计异常流量设备事件事件总数 -->
	<select id="pgAdminquery_abnormal_flow_devices.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM
		(SELECT * FROM "tbl_abnormal_flow_device_events" WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		 <!-- "tbl_abnormal_flow_device_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_abnormal_flow_device_events" WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty> -->
			<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>


	<!-- 异常流量设备事件 -->
	<select id="pgAdminquery.abnormal_flow_device" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_abnormal_flow_device_events" WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_abnormal_flow_device_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_abnormal_flow_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>
	
	<!-- 统计服务器事件总数 -->
	<select id="pgAdminqueryServerEvents.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT * FROM "tbl_server_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where 1=1 
		
		<!-- <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 服务事件 -->
	<select id="pgAdminquery.ServerEvents" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY" ,"REL_ASSET_ID" FROM
		(SELECT * FROM "tbl_server_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ids">
          <![CDATA[
            "EVENTS_ID" in($ids$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		limit 1000 offset 0
		) as temp 
		where  1=1
		<!-- <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty> -->
		order by "EVENTS_BEGINTIME" desc
	</select>

	<!-- 插入认证失败 -->
	<insert id="pgAdmininsert.attestation_failde" parameterClass="summaryEvents">
		INSERT
		INTO tbl_server_events("EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME",
		"REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#,
		#eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId#)
	</insert>


	<!-- 插入认证成功 -->
	<insert id="pgAdmininsert.attestation_success" parameterClass="summaryEvents">
		INSERT
		INTO tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME",
		"REL_LOG_TABLE_NAME" ,"REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#,
		#eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId#)
	</insert>

	<!-- 插入资源耗尽CPU -->
	<insert id="pgAdmininsert.CPU_depletion" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME"  ,"REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId#)
	</insert>

	<!-- 插入资源耗尽内存 -->
	<insert id="pgAdmininsert.memory_depletion" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>


	<!-- 插入配置变更 -->
	<insert id="pgAdmininsert.configuration" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>

	<!-- 插入配置错误 -->
	<insert id="pgAdmininsert.configError" parameterClass="summaryEvents">
		INSERT INTO
		tbl_serv_erevents(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>


	<!-- 插入操作 -->
	<insert id="pgAdmininsert.related_operation" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME" ,"REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>


	<!--查询认证与验证总条数 -->
	<select id="pgAdminqueryeventssf.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (SELECT "EVENTS_ID" FROM
		"tbl_attestation_failde" WHERE "EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_attestation_failde" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID" FROM "tbl_attestation_success" WHERE
		"EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_success"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		) FS WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 认证与验证 -->
	<select id="pgAdminquery.attestation_sf" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_attestation_failde"
		WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_failde")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_attestation_success"
		WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_success")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		ORDER BY "EVENTS_TYPE" ASC
	</select>

	<!-- 认证失败总条数 -->
	<select id="pgAdminqueryeventsFailde.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_attestation_failde" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_failde" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 认证成功总条数 -->
	<select id="pgAdminqueryeventsSuccess.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_attestation_success" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_success" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 认证成功 -->
	<select id="pgAdminquery.attestationSuccess" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY"FROM
		"tbl_attestation_success" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_attestation_success")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		ORDER BY "EVENTS_TYPE" ASC
	</select>

	<!-- 监控用的sql语句 -->

	<!-- 插入ftp类事件 -->
	<insert id="pgAdmininsert.monitorFtp" parameterClass="java.util.HashMap">
		INSERT INTO
		tbl_monitor_ftp_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<!-- 插入telnet事件 -->
	<insert id="pgAdmininsert.monitorTelnet" parameterClass="java.util.HashMap">
		INSERT INTO
		tbl_monitor_telnet_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<!-- 插入连接被阻事件 -->
	<insert id="pgAdmininsert.monitorConnectRefuse" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_connectRefuse_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="pgAdmininsert.monitorAccountLocked" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_accountLock_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="pgAdmininsert.monitorAccountLogin" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_accountLogin_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="pgAdmininsert.monitorAccountManage" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_accountManage_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="pgAdmininsert.monitorPrivilege" parameterClass="java.util.HashMap">
		INSERT INTO
		tbl_monitor_privilege_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)

	</insert>


<!-- 服务器类事件统计 -->
	<select id="pgAdminqueryServer.countAll" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_server_events" WHERE 1= 1
		<!-- 时间 -->
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<!--类型 -->
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_DEVPRODUCT" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 按照服务器类型统计 -->
	<select id="pgAdminqueryServer.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_DEVPRODUCT" AS "key",sum("EVENTS_NUMBER") as
		"count"
		FROM "tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_DEVPRODUCT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>


	<!-- 应用服务器源地址统计 -->
	<select id="pgAdminqueryServer.countBySouurceIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") as
		"count"
		FROM "tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>


	<!-- 认证成功统计 -->
	<select id="pgAdminqueryeventsSuccess.countAll" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_attestation_success" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证失败统计 -->
	<select id="pgAdminqueryeventsFailde.countAll" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count", "REL_ASSET_NAME" AS "key" FROM
		"tbl_attestation_failde" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证失败来源ip统计 -->
	<select id="pgAdminqueryeventsFailde.countByIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key", sum("EVENTS_NUMBER") as
		"count"
		FROM "tbl_attestation_failde" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
            "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<!-- 根据类型 -->
		<isNotEmpty prepend="AND" property="type">
        <![CDATA[
          "EVENTS_TYPE" = #type#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证成功来源Ip统计 -->
	<select id="pgAdminqueryeventsSuccess.countByIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key" , sum("EVENTS_NUMBER") as
		"count"
		FROM "tbl_attestation_success" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
        <![CDATA[
          "EVENTS_TYPE" = #type#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证成功类型统计 -->
	<select id="pgAdminqueryeventsSuccess.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_TYPE" AS "key" ,sum("EVENTS_NUMBER") AS "count" FROM
		"tbl_attestation_success" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		GROUP BY "EVENTS_TYPE"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证失败类型统计 -->
	<select id="pgAdminqueryeventsFailde.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_TYPE" AS "key", sum("EVENTS_NUMBER") AS "count" FROM
		"tbl_attestation_failde" WHERE 1 = 1
		<!-- 时间 -->
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		GROUP BY "EVENTS_TYPE"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- VPN事件 统计 -->
	<select id="pgAdminqueryVpn.count" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_vpn_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		<!-- 事件产生的源 -->
		<isNotEmpty prepend="AND" property="type">
			"EVENTS_DEVPRODUCT" =
			#type#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devType">
			"EVENTS_DEVTYPE" SIMILAR
			TO '%($devType$)%'
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- vpn事件根据产生源统计 -->
	<select id="pgAdminqueryVpn.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") as
		"count"
		FROM "tbl_vpn_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 数据库事件统计 -->
	<select id="pgAdminqueryDatabase.count" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_database_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
           <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
		  <![CDATA[
		    "EVENTS_DEVPRODUCT" = #type#
		  ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 数据库事件按照产生源统计 -->
	<select id="pgAdminqueryDatabase.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") as
		"count"
		FROM "tbl_database_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 负载均衡统计 -->
	<select id="pgAdminqueryLoadBalance.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_load_balance_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
			"EVENTS_DEVPRODUCT" =
			#type#
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 负载均衡按照事件源统计 -->
	<select id="pgAdminqueryLoadBalance.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_load_balance_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 内容过滤网关统计 -->
	<select id="pgAdminqueryContentFilteringGateway.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_content_filtering_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	     <![CDATA[
	        "EVENTS_PUTTIME" > #value#
	     ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	     <![CDATA[
	       "EVENTS_DEVPRODUCT" = #type#
	     ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 内容过滤网关按照设备源统计 -->
	<select id="pgAdminqueryContentFilteringGateway.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_content_filtering_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证系统统计 -->
	<select id="pgAdminqueryAuthenticationSystem.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_authentication_system_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
	           "EVENTS_PUTTIME" > #value#
	       ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 认证系统按照事件源统计 -->
	<select id="pgAdminqueryAuthenticationSystem.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_authentication_system_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!--异常流量设备统计 -->
	<select id="pgAdminqueryAbnormalFlowDevice.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_abnormal_flow_device_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 异常流量设备按照事件源统计 -->
	<select id="pgAdminqueryAbnormalFlowDevice.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_abnormal_flow_device_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 阻拒服务器攻击事件统计 -->
	<select id="pgAdminqueryResistanceRefuseServerAttack.count"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_resistance_refuse_server_attack_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 阻拒服务器攻击事件产生源统计 -->
	<select id="pgAdminqueryResistanceRefuseServerAttack.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_resistance_refuse_server_attack_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- Web防火墙统计 -->
	<select id="pgAdminqueryAntivirusWebEvents.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_antivirus_web_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		order by "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- Web防火墙事件源统计 -->
	<select id="pgAdminqueryAntivirusWebEvents.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_antivirus_web_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!--数据库审计产品事件统计 -->
	<select id="pgAdminqueryDatabaseAuditProducts.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_database_audit_products_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP By "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!--数据库审计产品事件事件源统计 -->
	<select id="pgAdminqueryDatabaseAuditProducts.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_database_audit_products_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 应用事件统计 -->
	<select id="pgAdminqueryApplication.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_application_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 应用事件事件源统计 -->
	<select id="pgAdminqueryApplication.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_application_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网闸事件统计 -->
	<select id="pgAdminqueryNetBrakeEvents.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_net_brake_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网闸事件事件源统计 -->
	<select id="pgAdminqueryNetBrakeEvents.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_net_brake_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网络设备事件统计 -->
	<select id="pgAdminqueryNetworkEquipment.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devType">
		   <![CDATA[
		   "EVENTS_DEVTYPE" SIMILAR TO '%($devType$)%'
		   ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网络设备源地址统计 -->
	<select id="pgAdminqueryNetworkEquipment.countSource" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网络设备源端口统计 -->
	<select id="pgAdminqueryNetworkEquipment.countSourcePort"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEPORT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_network_equipment_events" WHERE 1 = 1 
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
	    AND "EVENTS_SOURCEPORT" > 0
		GROUP BY "EVENTS_SOURCEPORT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网络设备目的地址统计 -->
	<select id="pgAdminqueryNetworkEquipment.countTarget" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_TARGETADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		
		GROUP BY "EVENTS_TARGETADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 网络设备事件目标端口统计 -->
	<select id="pgAdminqueryNetworkEquipment.countTargetPort"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "EVENTS_TARGETPORT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		and "EVENTS_TARGETPORT" > 0
		GROUP BY "EVENTS_TARGETPORT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!--网络设备事件事件源统计 -->
	<select id="pgAdminqueryNetworkEquipment.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_DEVPRODUCT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_DEVPRODUCT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 终端安全管理系统事件统计 -->
	<select id="pgAdminqueryTerminalSecurity.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_terminal_security_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 终端安全事件事件源统计 -->
	<select id="pgAdminqueryTerminalSecurity.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_terminal_security_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!--防火墙事件统计 -->
	<select id="pgAdminqueryFirewall.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<!-- <isNotEmpty prepend="AND" property="policy"> <![CDATA[ "EVENTS_POLICY" 
			= #policy# ]]> </isNotEmpty> -->

		<!-- <isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 防火墙事件事件源统计 -->
	<select id="pgAdminqueryFirewall.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 连接被阻断事件 -->
	<select id="pgAdminqueryConnectRefuse.countSource" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_SOURCEADDT" AS "key"
		FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policy">
		     <![CDATA[
		     "EVENTS_POLICY" = #policy#
		     ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 连接被阻断 -->
	<select id="pgAdminqueryConnectRefuse.countTarget" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_TARGETADDT" AS "key"
		FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policy">
		     <![CDATA[
		     "EVENTS_POLICY" = #policy#
		     ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_TARGETADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>


	<!-- 中间事件 -->
	<select id="pgAdminqueryIntermediate.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intermediate_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 中间事件事件源统计 -->
	<select id="pgAdminqueryIntermediate.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_intermediate_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 入侵防御系统事件统计 -->
	<select id="pgAdminqueryIntrusionDefense.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 入侵防御系统事件事件源统计 -->
	<select id="pgAdminqueryIntrusionDefense.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 入侵检测事件统计 -->
	<select id="pgAdminqueryIntrusionDetection.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 入侵检测事件事件源统计 -->
	<select id="pgAdminqueryIntrusionDetection.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT "EVENTS_SOURCEADDT" AS "key",sum("EVENTS_NUMBER") AS
		"count"
		FROM "tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 安全设备事件 -->
	<select id="pgAdminquerysafetyDevice.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)as temp
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
		
		<!-- "tbl_safety_device_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		
	</select>

	<!-- 安全设备事件源地址排行 -->
	<select id="pgAdminquerysafetyDevice.countSource" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_SOURCEADDT" AS "key"
		FROM 
		<!-- <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)as temp
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 安全设备事件目标地址排行 -->
	<select id="pgAdminquerysafetyDevice.countTarget" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_TARGETADDT" AS "key"
		FROM 
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)as temp
		<!-- <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		GROUP BY "EVENTS_TARGETADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 安全设备事件来源端口排行 -->
	<select id="pgAdminquerysafetyDevice.countSourcePort" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_SOURCEPORT" AS "key"
		FROM 
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1 AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1  AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1  AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1  AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)as temp
		<!-- <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		GROUP BY "EVENTS_SOURCEPORT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 安全设备事件目标端口排行 -->
	<select id="pgAdminquerysafetyDevice.countTargetPort" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_TARGETPORT" AS "key"
		FROM 
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)as temp
		GROUP BY "EVENTS_TARGETPORT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
	<!-- 主机类认证成功 -->
   <select id="pgAdminqueryServer.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
	<!-- 主机类认证失败 -->
	 <select id="pgAdminqueryServer.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
	<!-- 主机类认证成功来源地址统计 -->
     <select id="pgAdminqueryServerSuccess.countByIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","EVENTS_SOURCEADDT" AS "key" FROM
		"tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
	<!-- 防火墙类认证成功 -->
    <select id="pgAdminqueryFirewall.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
	 <select id="pgAdminqueryFirewall.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
    <!-- 网络设备认证成功 -->
   <select id="pgAdminqueryNetwork.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
    
    <!-- 网络设备认证失败 -->
	<select id="pgAdminqueryNetwork.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
	
    
     <!-- 入侵检测系统认证成功 -->
    <select id="pgAdminqueryIntrusionDetection.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
    
    <!-- 入侵检测事件认证失败 -->
	
	 <select id="pgAdminqueryIntrusionDetection.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
    <!-- 入侵防御系统事件认证成功 -->
     <select id="pgAdminqueryIntrusionDefense.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
    
    <!-- 入侵防御系统事件认证失败 -->
	 <select id="pgAdminqueryIntrusionDefense.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 监控管理完毕 -->

	<!-- 认证失败 -->
	<select id="pgAdminquery.attestationFailde" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_attestation_failde"
		WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_failde")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		ORDER BY "EVENTS_TYPE" ASC
	</select>


	<!--查询资源耗尽总条数 -->
	<select id="pgAdminqueryeventsCM.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (SELECT "EVENTS_ID" FROM
		"tbl_CPU_depletion" WHERE "EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID" FROM "tbl_memory_depletion" WHERE
		"EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_memory_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		) FS WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- cpu总条数 -->
	<select id="pgAdminqueryeventsCPU.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_CPU_depletion" WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 内存总条数 -->
	<select id="pgAdminqueryeventsMemory.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_memory_depletion" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_memory_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 查询资源耗尽 -->
	<select id="pgAdminquery.depletion" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_CPU_depletion" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_CPU_depletion" )
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_memory_depletion"
		WHERE
		"EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_memory_depletion")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- CPU耗尽 -->
	<select id="pgAdminquery.cpudepletion" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_CPU_depletion" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_CPU_depletion")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 内存耗尽 -->
	<select id="pgAdminquery.memorydepletion" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT"EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_memory_depletion" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_memory_depletion")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 操作总条数 -->
	<select id="pgAdminqueryeventsOperation.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_related_operation" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_related_operation" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 操作 -->
	<select id="pgAdminquery.operation" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_related_operation" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_related_operation")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!--配置变更总条数 -->
	<select id="pgAdminqueryeventsConfig.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (SELECT "EVENTS_ID" FROM
		"tbl_configuration" WHERE "EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_configuration" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID" FROM "tbl_configurationerror" WHERE
		"EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_configurationerror" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		) FS WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 配置变更 -->
	<select id="pgAdminquery.config_ue" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configuration" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_configuration")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		"EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_configurationerror"
		WHERE
		"EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_configurationerror")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 配置变更总条数 -->
	<select id="pgAdminqueryeventsCU.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_configuration" WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM "tbl_configuration" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 配置变更 -->
	<select id="pgAdminquery.configuration" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configuration" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_configuration")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 配置变更总条数 -->
	<select id="pgAdminqueryeventsConfigError.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_configurationerror" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_configurationerror" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 配置错误 -->
	<select id="pgAdminquery.configerror" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configurationerror" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_configurationerror")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 网络异常 -->
	<select id="pgAdminqueryAnomaly.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT count("EVENTS_ID") FROM "tbl_anomaly" WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM "tbl_anomaly" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 网络异常 -->
	<select id="pgAdminquery.anomaly" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_anomaly" WHERE "EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID"
		FROM "tbl_anomaly")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 近期事件 -->
	<select id="pgAdminquery.recent" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_memory_depletion"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_configuration" WHERE
		1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_configurationerror"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_related_operation"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_server_events" WHERE
		1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_abnormal_flow_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_antivirus_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_antivirus_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_antivirus_web_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[ 
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_application_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_authentication_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_content_filtering_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_database_audit_products_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_database_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_intermediate_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_intrusion_defense_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_intrusion_detection_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_net_brake_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_network_equipment_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_safety_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_terminal_security_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_vpn_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 近期事件总条 数 -->
	<select id="pgAdminqueryRecent.count" resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (
		   SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_memory_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configuration" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configurationerror" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_related_operation" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_server_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_abnormal_flow_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_antivirus_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_antivirus_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_antivirus_web_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_application_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_authentication_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_content_filtering_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_database_audit_products_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_database_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_intermediate_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_intrusion_defense_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_intrusion_detection_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_net_brake_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_network_equipment_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_safety_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_terminal_security_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_vpn_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		) R
	</select>


	<!-- 查询关联分析总条数 -->
	<select id="pgAdminRelevanceAnalysis_cache.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM cache_relevance_analysis WHERE
		"REL_IDENTIFICATION" =
		CAST(#relId# AS bigint)
	</select>

	<!-- 查询关联分析cache表 -->
	<select id="pgAdminquery.RelevanceAnalysis_cache" resultClass="java.util.HashMap"
		parameterClass="Long">
		SELECT "LOG_IDENTIFICATION", "LOG_TYPE", "LOG_NAME",
		"LOG_RAWID",
		"LOG_PROGRAMTYPE",
		"LOG_DEVTYPE", "LOG_ACTION",
		"LOG_CUSTOMS2", "LOG_MSG", "LOG_DEVVENDOR",
		"LOG_RESOURCE",
		"LOG_DEVPRODUCT", "LOG_RESULT", "LOG_SYSTYPE",
		"LOG_PROGRAM",
		"LOG_PRIORITY", "LOG_SADDR", "LOG_SPORT", "LOG_DADDR",
		"LOG_DPORT",
		"LOG_AGGREGATED_COUNT", "LOG_SENDTIME",
		"REL_IDENTIFICATION","TABLE_NAME"
		FROM cache_relevance_analysis WHERE
		"REL_IDENTIFICATION" = #relId# ORDER
		BY "REL_IDENTIFICATION" DESC
	</select>

	<select id="pgAdminquery.protocol" resultClass="java.util.HashMap">
		SELECT "ID", "ObjID",
		"ObjType", "Name", "Alias", "Protocol", "Port",
		"Comment"
		FROM
		"tbl_dynamicservice";
	</select>
	
	<!-- 显示本天的最新的1000条数据 -->
	  <select id="pgAdminquery.recentEvents" parameterClass="java.util.HashMap" resultMap="eventsLogResult">
	     SELECT * FROM
	    (SELECT * FROM $tableName$ where 1=1

	    <isNotEmpty property="priority" prepend="AND">
	      <![CDATA[
	        "LOG_PRIORITY" = #priority#
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="devproduct" prepend="AND">
	     <![CDATA[
	        "LOG_DEVPRODUCT" LIKE '%$devproduct$%'
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="type" prepend="AND">
	     <![CDATA[
	        "LOG_TYPE" = '$type$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty property="category" prepend="AND">
	       <![CDATA[
	          "LOG_CATEGORY" = '$category$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="highrank">
	    	"LOG_PRIORITY" in ($highrank$)
	    </isNotEmpty>
	        <isNotEmpty prepend="AND" property="assetId">
         <![CDATA[

            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsLogIdentifications">
	         "LOG_IDENTIFICATION" in $eventsLogIdentifications$
	    </isNotEmpty>
	    order by "LOG_ID" DESC
	     <isEmpty property="flag">
	         LIMIT 1000 OFFSET 0 
	    </isEmpty>
	    ) AS TB WHERE 1=1 ORDER BY "LOG_RECEPT_TIME"  DESC
	  </select> 
	  
	  
	 <!-- 修改增加高级查询条件 -->
	  <select id="pgAdminquery.recentEventsCount" parameterClass="java.util.HashMap" resultClass="int">
	    SELECT COUNT("LOG_ID") FROM
	    (SELECT "LOG_ID" FROM $tableName$ where 1=1
	         <isNotEmpty property="priority" prepend="AND">
	      <![CDATA[
	        "LOG_PRIORITY" = #priority#
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="devproduct" prepend="AND">
	     <![CDATA[
	        "LOG_DEVPRODUCT" LIKE '%$devproduct$%'
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="type" prepend="AND">
	     <![CDATA[
	        "LOG_TYPE" = '$type$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty property="category" prepend="AND">
	       <![CDATA[
	          "LOG_CATEGORY" = '$category$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="highrank">
	    	"LOG_PRIORITY" in ($highrank$)
	    </isNotEmpty>
	        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsLogIdentifications">
	         "LOG_IDENTIFICATION" in $eventsLogIdentifications$
	    </isNotEmpty>
	    order by "LOG_ID" DESC 
	    <isEmpty property="flag">
	         LIMIT 1000 OFFSET 0 
	    </isEmpty>
	    ) AS TB
	  </select>
	  
	<select id="pgAdminquery.event.definition" resultClass="java.util.HashMap">
		SELECT "ID", "NAME", "TYPE"
		FROM
		"tbl_event_definition")
	</select>
	<select id="pgAdminquery.existsTable" parameterClass="String"
		resultClass="int">
		SELECT count(*) FROM pg_tables WHERE tablename =
		#tableName#
	</select>
 <!-- 查看本天的未 定义事件 -->
	 <select id="pgAdminquery.undefinedEventsCount" parameterClass="java.util.HashMap" resultClass="int">
	      SELECT COUNT(*) FROM $tableName$ WHERE 1 = 1
	        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
	 </select>
	 
	 <select id="pgAdminquery.undefinedEvents" parameterClass="java.util.HashMap" resultMap="eventsLogResult">
	      SELECT * FROM $tableName$ WHERE 1 = 1 
	        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
	       ORDER BY "LOG_ID" DESC
	  </select> 
	  <!-- 自定义监控图表 -->
	  <select id="pgAdmincustomMonitor.query" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" >
	    select key,sum(count) as count  from  
($sql$)
as e group by key order by count desc limit #topN#
	        
	  </select> 
<!-- sqlserver -->
	<!--vpn事件 -->
	<insert id="sqlServerinsert.vpn_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_vpn_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY"
		,"REL_ASSET_ID"
		)
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>



	<!--终端安全事件 -->
	<insert id="sqlServerinsert.terminal_security_events" parameterClass="summaryEvents">
		INSERT INTO tbl_terminal_security_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>
	
	<!--安全设备事件 -->
	<insert id="sqlServerinsert.safety_device_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_safety_device_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!--阻拒绝服务器攻击事件 -->
	<insert id="sqlServerinsert.resistance_refuse_server_attack_events"
		parameterClass="summaryEvents">
		INSERT INTO tbl_resistance_refuse_server_attack_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!--网络设备事件 -->
	<insert id="sqlServerinsert.network_equipment_events" parameterClass="summaryEvents">
		INSERT INTO tbl_network_equipment_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!--负载平衡事件 -->
	<insert id="sqlServerinsert.load_balance_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_load_balance_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!--入侵检测事件 -->
	<insert id="sqlServerinsert.intrusion_detection_events" parameterClass="summaryEvents">
		INSERT INTO tbl_intrusion_detection_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>
	
	<!--入侵防御事件 -->
	<insert id="sqlServerinsert.intrusion_defense_events" parameterClass="summaryEvents">
		INSERT INTO tbl_intrusion_defense_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!--中间事件 -->
	<insert id="sqlServerinsert.intermediate_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_intermediate_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 事件 -->
	<insert id="sqlServerinsert.firewall_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_firewall_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 数据库事件 -->
	<insert id="sqlServerinsert.database_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_database_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 数据库审计产品事件 -->
	<insert id="sqlServerinsert.database_audit_products_events"
		parameterClass="summaryEvents">
		INSERT INTO tbl_database_audit_products_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>
	<!-- 内容过滤网关 -->
	<insert id="sqlServerinsert.content_filtering_gateway_events"
		parameterClass="summaryEvents">
		INSERT INTO tbl_content_filtering_gateway_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 认证系统 -->
	<insert id="sqlServerinsert.authentication_system_events" parameterClass="summaryEvents">
		INSERT INTO tbl_authentication_system_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!-- 应用事件 -->
	<insert id="sqlServerinsert.application_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_application_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- WEB防火墙 -->
	<insert id="sqlServerinsert.antivirus_web_events" parameterClass="summaryEvents">
		INSERT
		INTO tbl_antivirus_web_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!--网闸事件 -->
	<insert id="sqlServerinsert.net_brake_events" parameterClass="summaryEvents">
		INSERT INTO
		tbl_net_brake_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 防毒系统事件 -->
	<insert id="sqlServerinsert.antivirus_system_events" parameterClass="summaryEvents">
		INSERT INTO tbl_antivirus_system_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>

	<!-- 防毒网关事件 -->
	<insert id="sqlServerinsert.antivirus_gateway_events" parameterClass="summaryEvents">
		INSERT INTO tbl_antivirus_gateway_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId#)
	</insert>


	<!-- 异常流量设备事件 -->
	<insert id="sqlServerinsert.abnormal_flow_device_events" parameterClass="summaryEvents">
		INSERT INTO tbl_abnormal_flow_device_events(
		"EVENTS_LEVEL",
		"EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT",
		"EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER",
		"EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>

	<!-- 插入服务器事件 -->
	<insert id="sqlServerinsert.serverEvents" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME","REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#,
		#eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#,
		#eventsNumber#, #eventsSource#,
		#eventsPutTime#,
		#eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#policy#,#assetId# )
	</insert>



	<!-- 统计VPN事件总数 -->
	<select id="sqlServerquery_vpn_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_vpn_events" WHERE
		 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		<!-- "tbl_vpn_events" WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_vpn_events" WHERE 1
		= 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>

	<!--VPN事件 -->
	<select id="sqlServerquery.vpn_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_vpn_events" WHERE
		 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_vpn_events"
		WHERE "EVENTS_ID" > ((SELECT
		MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_vpn_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 统计终端安全事件总数 -->
	<select id="sqlServerquery_terminal_security_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_terminal_security_events"
		 WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		<!-- "tbl_terminal_security_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_terminal_security_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--终端安全事件 -->
	<select id="sqlServerquery.terminal_security_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_terminal_security_events"
		 WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_terminal_security_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_terminal_security_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计安全设备事件总数 -->
	<select id="sqlServerquery_safety_device_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_safety_device_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		<!--  "tbl_safety_device_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_safety_device_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" LIKE '$type$'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--安全设备事件 -->
	<select id="sqlServerquery.safety_device_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_safety_device_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ids">
          <![CDATA[
           "EVENTS_ID" in ($ids$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc 
		<!--  "tbl_safety_device_events"
		WHERE "EVENTS_ID"
		> ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_safety_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" LIKE '$type$'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>

	<!-- 统计阻拒绝服务器攻击事件总数 -->
	<select id="sqlServerquery_resistance_refuse_server_attack_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM
		(SELECT  TOP 1000 * FROM "tbl_resistance_refuse_server_attack_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		
		 )temp
		 where 1 = 1 
		<!-- "tbl_resistance_refuse_server_attack_events" WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>



	<!--阻拒绝服务器攻击事件 -->
	<select id="sqlServerquery.resistance_refuse_server_attack_events"
		resultMap="summaryEventsResult" parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_resistance_refuse_server_attack_events"
		 where 1 = 1 
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		 )temp
		 where 1 = 1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_resistance_refuse_server_attack_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计网络设备事件总数 -->
	<select id="sqlServerquery_network_equipment_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_network_equipment_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		
		)temp 
		where 1=1 
		<!-- "tbl_network_equipment_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_network_equipment_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--网络设备事件 -->
	<select id="sqlServerquery.network_equipment_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_network_equipment_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!--"tbl_network_equipment_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		
		"tbl_network_equipment_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
           "EVENTS_DEVPRODUCT" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>

	<!-- 统计网闸事件总数 -->
	<select id="sqlServerquery_net_brake_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000  * FROM "tbl_net_brake_events"
		   where 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		<!-- "tbl_net_brake_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_net_brake_events" WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--网闸事件 -->
	<select id="sqlServerquery.net_brake_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000  * FROM "tbl_net_brake_events"
		   where 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- 
		"tbl_net_brake_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_net_brake_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
           "EVENTS_DEVTYPE" LIKE '%$devtype$%'
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 统计负载平衡事件总数 -->
	<select id="sqlServerquery_load_balance_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_load_balance_events"
		  where 1 = 1
		  <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		<!-- "tbl_load_balance_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_load_balance_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--负载平衡事件 -->
	<select id="sqlServerquery.load_balance_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000  * FROM "tbl_load_balance_events"
		  where 1 = 1
		  <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		
		)temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_load_balance_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_load_balance_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
			<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计入侵检测事件总数 -->
	<select id="sqlServerquery_intrusion_detection_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_intrusion_detection_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		
		<!-- "tbl_intrusion_detection_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_intrusion_detection_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--入侵检测事件 -->
	<select id="sqlServerquery.intrusion_detection_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_intrusion_detection_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		
		)temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!--  "tbl_intrusion_detection_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_intrusion_detection_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>


	<!-- 统计入侵防御事件总数 -->
	<select id="sqlServerquery_intrusion_defense_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_intrusion_defense_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		<!-- "tbl_intrusion_defense_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_intrusion_defense_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--入侵防御事件 -->
	<select id="sqlServerquery.intrusion_defense_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_intrusion_defense_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!--  "tbl_intrusion_defense_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_intrusion_defense_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>

	<!-- 统计中间事件总数 -->
	<select id="sqlServerquery_intermediate_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_intermediate_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		<!-- "tbl_intermediate_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_intermediate_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->

	</select>



	<!--中间事件 -->
	<select id="sqlServerquery.intermediate_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_intermediate_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_intermediate_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_intermediate_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="programtype">
          <![CDATA[
            "EVENTS_PROGRAMTYPE" = #programtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 网神SecGate防火墙总数 -->
	<select id="sqlServerquery_firewall_secgate_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1
		<!--"tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>


	<!-- 网神SecGate防火墙 -->
	<select id="sqlServerquery.firewall_secgate_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
          <![CDATA[
            "EVENTS_TYPE" = #type#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
             "EVENTS_RAWID"  <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 重点攻击防范 总数 -->
	<select id="sqlServerquery_firewall_zdfy_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
			(SELECT TOP 1000 * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		<!-- "tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!--重点攻击防范 -->
	<select id="sqlServerquery.firewall_zdfy_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
             "EVENTS_RAWID"  IN ($rawid1$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!-- CiscoPIX防火墙 总数 -->
	<select id="sqlServerquery_firewall_ciscopix_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1 
		<!-- "tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1

		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!--CiscoPIX防火墙 -->
	<select id="sqlServerquery.firewall_ciscopix_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc 
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid1">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid1# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid2">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid2# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid3">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid3# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid4">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid4# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid5">
          <![CDATA[
            "EVENTS_RAWID" >= CAST(#rawid5# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid6">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid6# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="rawid7">
          <![CDATA[
            "EVENTS_RAWID" >=CAST(#rawid7# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid8">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid8# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid9">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid9# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid10">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid10# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="rawid11">
          <![CDATA[
            "EVENTS_RAWID" <= CAST(#rawid11# AS integer)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>


	<!-- 统计防火墙事件总数 -->
	<select id="sqlServerquery_firewall_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		
		<!-- "tbl_firewall_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_firewall_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--防火墙事件 -->
	<select id="sqlServerquery.firewall_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_firewall_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_firewall_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" = #devtype# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>


	<!-- 统计数据库事件总数 -->
	<select id="sqlServerquery_database_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_database_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		<!-- "tbl_database_events" WHERE "EVENTS_ID"
		>
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM "tbl_database_events"
		WHERE 1 =
		1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
	</select>



	<!--数据库事件 -->
	<select id="sqlServerquery.database_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000  * FROM "tbl_database_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		<!--"tbl_database_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_database_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>-->
		order by "EVENTS_BEGINTIME" desc
	</select>


	<!-- 统计数据库审计产品事件总数 -->
	<select id="sqlServerquery_database_audit_products_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_database_audit_products_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1 
		<!-- "tbl_database_audit_products_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_database_audit_products_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="OR" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>



	<!--内容数据库审计产品事件 -->
	<select id="sqlServerquery.database_audit_products_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_database_audit_products_events"
		 WHERE 1 = 1
		 <isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1 
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_database_audit_products_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_database_audit_products_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 统计内容过滤网关事件总数 -->
	<select id="sqlServerquery_content_filtering_gateway_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM <!-- "tbl_content_filtering_gateway_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_content_filtering_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		(
		  SELECT TOP 1000 * FROM "tbl_content_filtering_gateway_events" where 1 = 1
		  <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		  </isNotEmpty>
		  order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!--内容过滤网关事件 -->
	<select id="sqlServerquery.content_filtering_gateway_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(
		   SELECT TOP 1000 * FROM "tbl_content_filtering_gateway_events"
		   where 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		  order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		
		<!-- "tbl_content_filtering_gateway_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_content_filtering_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>

	<!-- 统计认证系统事件总数 -->
	<select id="sqlServerquery_authentication_system_events.count"
		resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM <!-- "tbl_authentication_system_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_authentication_system_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		(select top 1000 * from "tbl_authentication_system_events" where 1 =1 
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1 

		

	</select>



	<!--认证系统事件 -->
	<select id="sqlServerquery.authentication_system_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(
		   SELECT TOP 1000 * FROM "tbl_authentication_system_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		  order by "EVENTS_ID" desc
		
		
		)temp 
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_authentication_system_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_authentication_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>


	<!-- 统计应用事件总数 -->
	<select id="sqlServerquery_application_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(
		 SELECT TOP 1000 * from "tbl_application_events"
		 where 1 =1 
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 =1 
		<!-- "tbl_application_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_application_events" WHERE 1
		= 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!-- 应用事件 -->
	<select id="sqlServerquery.application_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_application_events"
		where 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_application_events"
		WHERE "EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM "tbl_application_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>


	<!-- 统计WEB防火墙事件总数 -->
	<select id="sqlServerquery_antivirus_web_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(
		 SELECT TOP 1000 * FROM "tbl_antivirus_web_events" where 1 = 1
		 <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 =1 
		<!-- "tbl_antivirus_web_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_antivirus_web_events" WHERE
		1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!-- WEB防火墙事件 -->
	<select id="sqlServerquery.antivirus_web_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(select top 1000  * FROM "tbl_antivirus_web_events" where 1 = 1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1 
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_antivirus_web_events"
		WHERE "EVENTS_ID"
		> ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_antivirus_web_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>



	<!-- 统计防毒系统事件总数 -->
	<select id="sqlServerquery_antivirus_system_events.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(SELECT top 1000  * FROM "tbl_antivirus_system_events"
		WHERE 1= 1
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		<!-- "tbl_antivirus_system_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_antivirus_system_events"
		WHERE 1 = 1
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>



	<!-- 防毒系统事件 -->
	<select id="sqlServerquery.antivirus_system_events" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_antivirus_system_events"
		where 1 = 1
        <isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp
		where 1 = 1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		
		<!-- "tbl_antivirus_system_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_antivirus_system_events" WHERE 1=1
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="OR" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" = #program# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>



	<!-- 统计杀毒网关事件总数 -->
	<select id="sqlServerquery_antivirus_aateway.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM 
		(SELECT TOP 1000 * FROM "tbl_antivirus_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		<!-- "tbl_antivirus_gateway_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_antivirus_gateway_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>

	<!-- 杀毒网关事件 -->
	<select id="sqlServerquery.antivirus_gateway" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_antivirus_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1 = 1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_antivirus_gateway_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_antivirus_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" = #devvendor# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>


	<!-- 统计异常流量设备事件事件总数 -->
	<select id="sqlServerquery_abnormal_flow_devices.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM
		(SELECT TOP 1000 * FROM "tbl_abnormal_flow_device_events" WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		 <!-- "tbl_abnormal_flow_device_events" WHERE
		"EVENTS_ID" >
		((SELECT MAX("EVENTS_ID") - 1000 AS "ID" FROM
		"tbl_abnormal_flow_device_events" WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty> -->
			<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
	</select>


	<!-- 异常流量设备事件 -->
	<select id="sqlServerquery.abnormal_flow_device" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY","REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_abnormal_flow_device_events" WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_BEGINTIME" desc
		<!-- "tbl_abnormal_flow_device_events"
		WHERE
		"EVENTS_ID" > ((SELECT MAX("EVENTS_ID") - 1000 AS "ID"
		FROM
		"tbl_abnormal_flow_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		))
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT"  = #devproduct# 
          ]]>
		</isNotEmpty> -->
		
	</select>
	
	<!-- 统计服务器事件总数 -->
	<select id="sqlServerqueryServerEvents.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM 
		(SELECT TOP 1000 * FROM "tbl_server_events"
		WHERE
		1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
            "EVENTS_LEVEL" = #eventsType#
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where 1=1 
		
		<!-- <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty> -->
	</select>

	<!-- 服务事件 -->
	<select id="sqlServerquery.ServerEvents" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME"
		,"REL_LOG_TABLE_NAME","EVENTS_POLICY" ,"REL_ASSET_ID" FROM
		(SELECT TOP 1000 * FROM "tbl_server_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '%$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="deviceIp">
          <![CDATA[
            "EVENTS_TARGETADD" = #deviceIp#  
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsType">
          <![CDATA[
           "EVENTS_LEVEL" = #eventsType# 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="sourceAdd">
          <![CDATA[
            "EVENTS_SOURCEADDT" LIKE '%$sourceAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="targetAdd">
          <![CDATA[
            "EVENTS_TARGETADDT" LIKE '%$targetAdd$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="ids">
          <![CDATA[
            "EVENTS_ID" in($ids$)
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
           "REL_ASSET_ID" in ($assetId$)
          ]]>
		</isNotEmpty>
		order by "EVENTS_ID" desc
		)temp 
		where  1=1
		<!-- <isNotEmpty prepend="AND" property="devproduct">
          <![CDATA[
            "EVENTS_DEVPRODUCT" LIKE '%$devproduct$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="program">
          <![CDATA[
            "EVENTS_PROGRAM" LIKE '%$program$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devtype">
          <![CDATA[
            "EVENTS_DEVTYPE" LIKE '$devtype$%' 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devvendor">
          <![CDATA[
            "EVENTS_DEVVENDOR" LIKE '%$devvendor$%' 
          ]]>
		</isNotEmpty> -->
		order by "EVENTS_BEGINTIME" desc
	</select>

	<!-- 插入认证失败 -->
	<insert id="sqlServerinsert.attestation_failde" parameterClass="summaryEvents">
		INSERT
		INTO tbl_server_events("EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME",
		"REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#,
		#eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId#)
	</insert>


	<!-- 插入认证成功 -->
	<insert id="sqlServerinsert.attestation_success" parameterClass="summaryEvents">
		INSERT
		INTO tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME",
		"REL_LOG_TABLE_NAME" ,"REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#,
		#eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId#)
	</insert>

	<!-- 插入资源耗尽CPU -->
	<insert id="sqlServerinsert.CPU_depletion" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME"  ,"REL_ASSET_ID")
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId#)
	</insert>

	<!-- 插入资源耗尽内存 -->
	<insert id="sqlServerinsert.memory_depletion" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>


	<!-- 插入配置变更 -->
	<insert id="sqlServerinsert.configuration" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>

	<!-- 插入配置错误 -->
	<insert id="sqlServerinsert.configError" parameterClass="summaryEvents">
		INSERT INTO
		tbl_serv_erevents(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME","REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>


	<!-- 插入操作 -->
	<insert id="sqlServerinsert.related_operation" parameterClass="summaryEvents">
		INSERT INTO
		tbl_server_events(
		"EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME", "REL_LOG_TABLE_NAME" ,"REL_ASSET_ID" )
		VALUES
		(#eventsLevel#,#eventsName#, #eventsSourceAdd#, #eventsSourcePort#,
		#eventsTargetAdd#,#eventsTargetPort#, #eventsNumber#, #eventsSource#,
		#eventsPutTime#, #eventsType#,#eventsSourceAddT#, #eventsTargetAddT#,
		#eventsTime#,#eventsLogIdentification#,#eventsDevProduct#,#eventsProgram#,
		#eventsDevType#,#eventsDevvendor#,#eventsDevName#,#eventsProgramtype#,#eventsCustomd1#,
		#eventsRawid#,#assetName#,#relLogTableName#,#assetId# )
	</insert>


	<!--查询认证与验证总条数 -->
	<select id="sqlServerqueryeventssf.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (SELECT "EVENTS_ID" FROM
		"tbl_attestation_failde" WHERE "EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_attestation_failde" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID" FROM "tbl_attestation_success" WHERE
		"EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_success"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		) FS WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 认证与验证 -->
	<select id="sqlServerquery.attestation_sf" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_attestation_failde"
		WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_failde")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_attestation_success"
		WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_success")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		ORDER BY "EVENTS_TYPE" ASC
	</select>

	<!-- 认证失败总条数 -->
	<select id="sqlServerqueryeventsFailde.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_attestation_failde" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_failde" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 认证成功总条数 -->
	<select id="sqlServerqueryeventsSuccess.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_attestation_success" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_success" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 认证成功 -->
	<select id="sqlServerquery.attestationSuccess" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY"FROM
		"tbl_attestation_success" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_attestation_success")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		ORDER BY "EVENTS_TYPE" ASC
	</select>

	<!-- 监控用的sql语句 -->

	<!-- 插入ftp类事件 -->
	<insert id="sqlServerinsert.monitorFtp" parameterClass="java.util.HashMap">
		INSERT INTO
		tbl_monitor_ftp_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<!-- 插入telnet事件 -->
	<insert id="sqlServerinsert.monitorTelnet" parameterClass="java.util.HashMap">
		INSERT INTO
		tbl_monitor_telnet_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<!-- 插入连接被阻事件 -->
	<insert id="sqlServerinsert.monitorConnectRefuse" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_connectRefuse_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="sqlServerinsert.monitorAccountLocked" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_accountLock_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="sqlServerinsert.monitorAccountLogin" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_accountLogin_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="sqlServerinsert.monitorAccountManage" parameterClass="java.util.HashMap">
		INSERT
		INTO
		tbl_monitor_accountManage_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)
	</insert>

	<insert id="sqlServerinsert.monitorPrivilege" parameterClass="java.util.HashMap">
		INSERT INTO
		tbl_monitor_privilege_events(
		"EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TYPE",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","EVENTS_POLICY","EVENTS_ACTION")
		VALUES
		(#priority#,#events_name#, #LOG_SADDR#, #LOG_SPORT#,
		#LOG_DADDR#,#LOG_DPORT#, #count#,
		#LOG_SNAME#,
		#events_puttime#,
		#LOG_TYPE#,
		#LOG_ID#,#LOG_DEVPRODUCT#,#LOG_PROGRAM#,
		#LOG_DEVTYPE#,#LOG_DEVVENDOR#,#LOG_DEVNAME#,#LOG_PROGRAMTYPE#,
		#LOG_CUSTOMD1#,#LOG_RAWID#,#LOG_POLICY#,#LOG_ACTION#)

	</insert>


<!-- 服务器类事件统计 -->
	<select id="sqlServerqueryServer.countAll" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_server_events" WHERE 1= 1
		<!-- 时间 -->
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<!--类型 -->
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_DEVPRODUCT" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 按照服务器类型统计 -->
	<select id="sqlServerqueryServer.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_DEVPRODUCT" AS 'key',sum("EVENTS_NUMBER") as
		'count'
		FROM "tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_DEVPRODUCT"
		ORDER BY 'count' DESC
	</select>


	<!-- 应用服务器源地址统计 -->
	<select id="sqlServerqueryServer.countBySouurceIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") as
		'count'
		FROM "tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>


	<!-- 认证成功统计 -->
	<select id="sqlServerqueryeventsSuccess.countAll" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_attestation_success" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证失败统计 -->
	<select id="sqlServerqueryeventsFailde.countAll" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count', "REL_ASSET_NAME" AS 'key' FROM
		"tbl_attestation_failde" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证失败来源ip统计 -->
	<select id="sqlServerqueryeventsFailde.countByIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key', sum("EVENTS_NUMBER") as
		'count'
		FROM "tbl_attestation_failde" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
            "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<!-- 根据类型 -->
		<isNotEmpty prepend="AND" property="type">
        <![CDATA[
          "EVENTS_TYPE" = #type#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证成功来源Ip统计 -->
	<select id="sqlServerqueryeventsSuccess.countByIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key' , sum("EVENTS_NUMBER") as
		'count'
		FROM "tbl_attestation_success" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
        <![CDATA[
          "EVENTS_TYPE" = #type#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证成功类型统计 -->
	<select id="sqlServerqueryeventsSuccess.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_TYPE" AS 'key' ,sum("EVENTS_NUMBER") AS 'count' FROM
		"tbl_attestation_success" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		GROUP BY "EVENTS_TYPE"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证失败类型统计 -->
	<select id="sqlServerqueryeventsFailde.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_TYPE" AS 'key', sum("EVENTS_NUMBER") AS 'count' FROM
		"tbl_attestation_failde" WHERE 1 = 1
		<!-- 时间 -->
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		GROUP BY "EVENTS_TYPE"
		ORDER BY 'count' DESC
	</select>

	<!-- VPN事件 统计 -->
	<select id="sqlServerqueryVpn.count" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_vpn_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
			"EVENTS_PUTTIME" >
			#value#
		</isNotEmpty>
		<!-- 事件产生的源 -->
		<isNotEmpty prepend="AND" property="type">
			"EVENTS_DEVPRODUCT" =
			#type#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devType">
			"EVENTS_DEVTYPE" SIMILAR
			TO '%($devType$)%'
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- vpn事件根据产生源统计 -->
	<select id="sqlServerqueryVpn.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") as
		'count'
		FROM "tbl_vpn_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 数据库事件统计 -->
	<select id="sqlServerqueryDatabase.count" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_database_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
           <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
		  <![CDATA[
		    "EVENTS_DEVPRODUCT" = #type#
		  ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 数据库事件按照产生源统计 -->
	<select id="sqlServerqueryDatabase.countByType" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") as
		'count'
		FROM "tbl_database_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 负载均衡统计 -->
	<select id="sqlServerqueryLoadBalance.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_load_balance_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
			"EVENTS_DEVPRODUCT" =
			#type#
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 负载均衡按照事件源统计 -->
	<select id="sqlServerqueryLoadBalance.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_load_balance_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 内容过滤网关统计 -->
	<select id="sqlServerqueryContentFilteringGateway.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_content_filtering_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	     <![CDATA[
	        "EVENTS_PUTTIME" > #value#
	     ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	     <![CDATA[
	       "EVENTS_DEVPRODUCT" = #type#
	     ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 内容过滤网关按照设备源统计 -->
	<select id="sqlServerqueryContentFilteringGateway.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_content_filtering_gateway_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证系统统计 -->
	<select id="sqlServerqueryAuthenticationSystem.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_authentication_system_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
	           "EVENTS_PUTTIME" > #value#
	       ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 认证系统按照事件源统计 -->
	<select id="sqlServerqueryAuthenticationSystem.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_authentication_system_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!--异常流量设备统计 -->
	<select id="sqlServerqueryAbnormalFlowDevice.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_abnormal_flow_device_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 异常流量设备按照事件源统计 -->
	<select id="sqlServerqueryAbnormalFlowDevice.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_abnormal_flow_device_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 阻拒服务器攻击事件统计 -->
	<select id="sqlServerqueryResistanceRefuseServerAttack.count"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_resistance_refuse_server_attack_events"
		WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 阻拒服务器攻击事件产生源统计 -->
	<select id="sqlServerqueryResistanceRefuseServerAttack.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_resistance_refuse_server_attack_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- Web防火墙统计 -->
	<select id="sqlServerqueryAntivirusWebEvents.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_antivirus_web_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		order by 'count' DESC
	</select>

	<!-- Web防火墙事件源统计 -->
	<select id="sqlServerqueryAntivirusWebEvents.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_antivirus_web_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!--数据库审计产品事件统计 -->
	<select id="sqlServerqueryDatabaseAuditProducts.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_database_audit_products_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP By "REL_ASSET_NAME"
		ORDER BY 'count' DESC
		
	</select>

	<!--数据库审计产品事件事件源统计 -->
	<select id="sqlServerqueryDatabaseAuditProducts.countByType"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_database_audit_products_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 应用事件统计 -->
	<select id="sqlServerqueryApplication.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_application_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 应用事件事件源统计 -->
	<select id="sqlServerqueryApplication.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_application_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 网闸事件统计 -->
	<select id="sqlServerqueryNetBrakeEvents.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_net_brake_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 网闸事件事件源统计 -->
	<select id="sqlServerqueryNetBrakeEvents.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_net_brake_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 网络设备事件统计 -->
	<select id="sqlServerqueryNetworkEquipment.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="devType">
		   <![CDATA[
		   "EVENTS_DEVTYPE" SIMILAR TO '%($devType$)%'
		   ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 网络设备源地址统计 -->
	<select id="sqlServerqueryNetworkEquipment.countSource" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 网络设备源端口统计 -->
	<select id="sqlServerqueryNetworkEquipment.countSourcePort"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT  TOP 5 "EVENTS_SOURCEPORT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_network_equipment_events" WHERE 1 = 1 
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
	    AND "EVENTS_SOURCEPORT" > 0
		GROUP BY "EVENTS_SOURCEPORT"
		ORDER BY 'count' DESC
	</select>

	<!-- 网络设备目的地址统计 -->
	<select id="sqlServerqueryNetworkEquipment.countTarget" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_TARGETADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		
		GROUP BY "EVENTS_TARGETADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 网络设备事件目标端口统计 -->
	<select id="sqlServerqueryNetworkEquipment.countTargetPort"
		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_TARGETPORT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		and "EVENTS_TARGETPORT" > 0
		GROUP BY "EVENTS_TARGETPORT"
		ORDER BY 'count' DESC
	</select>

	<!--网络设备事件事件源统计 -->
	<select id="sqlServerqueryNetworkEquipment.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_DEVPRODUCT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_DEVPRODUCT"
		ORDER BY 'count' DESC
	</select>

	<!-- 终端安全管理系统事件统计 -->
	<select id="sqlServerqueryTerminalSecurity.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_terminal_security_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 终端安全事件事件源统计 -->
	<select id="sqlServerqueryTerminalSecurity.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_terminal_security_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
		
	</select>

	<!--防火墙事件统计 -->
	<select id="sqlServerqueryFirewall.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<!-- <isNotEmpty prepend="AND" property="policy"> <![CDATA[ "EVENTS_POLICY" 
			= #policy# ]]> </isNotEmpty> -->

		<!-- <isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 防火墙事件事件源统计 -->
	<select id="sqlServerqueryFirewall.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 连接被阻断事件 -->
	<select id="sqlServerqueryConnectRefuse.countSource" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_SOURCEADDT" AS 'key'
		FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policy">
		     <![CDATA[
		     "EVENTS_POLICY" = #policy#
		     ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 连接被阻断 -->
	<select id="sqlServerqueryConnectRefuse.countTarget" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_TARGETADDT" AS 'key'
		FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="policy">
		     <![CDATA[
		     "EVENTS_POLICY" = #policy#
		     ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_TARGETADDT"
		ORDER BY 'count' DESC
	</select>


	<!-- 中间事件 -->
	<select id="sqlServerqueryIntermediate.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_intermediate_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 中间事件事件源统计 -->
	<select id="sqlServerqueryIntermediate.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_intermediate_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 入侵防御系统事件统计 -->
	<select id="sqlServerqueryIntrusionDefense.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 入侵防御系统事件事件源统计 -->
	<select id="sqlServerqueryIntrusionDefense.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT  TOP 5 "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 入侵检测事件统计 -->
	<select id="sqlServerqueryIntrusionDetection.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>

	<!-- 入侵检测事件事件源统计 -->
	<select id="sqlServerqueryIntrusionDetection.countByType" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5  "EVENTS_SOURCEADDT" AS 'key',sum("EVENTS_NUMBER") AS
		'count'
		FROM "tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 安全设备事件 -->
	<select id="sqlServerquerysafetyDevice.count" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)temp
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
		
		
		<!-- "tbl_safety_device_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		
	</select>

	<!-- 安全设备事件源地址排行 -->
	<select id="sqlServerquerysafetyDevice.countSource" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_SOURCEADDT" AS 'key'
		FROM 
		<!-- <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)temp
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 安全设备事件目标地址排行 -->
	<select id="sqlServerquerysafetyDevice.countTarget" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_TARGETADDT" AS 'key'
		FROM 
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)temp
		<!-- <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		GROUP BY "EVENTS_TARGETADDT"
		ORDER BY 'count' DESC
	</select>

	<!-- 安全设备事件来源端口排行 -->
	<select id="sqlServerquerysafetyDevice.countSourcePort" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_SOURCEPORT" AS 'key'
		FROM 
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1 AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1  AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1  AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1  AND "EVENTS_SOURCEPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)temp
		<!-- <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty> -->
		GROUP BY "EVENTS_SOURCEPORT"
		ORDER BY 'count' DESC
	</select>

	<!-- 安全设备事件目标端口排行 -->
	<select id="sqlServerquerysafetyDevice.countTargetPort" parameterClass="java.util.HashMap"
		resultClass="java.util.HashMap">
		SELECT  top 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_TARGETPORT" AS 'key'
		FROM 
		((SELECT * FROM "tbl_firewall_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_defense_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_intrusion_detection_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		UNION ALL
		(SELECT * FROM "tbl_safety_device_events"
		   WHERE 1 = 1 AND "EVENTS_TARGETPORT" >0
		   <isNotEmpty prepend="AND" property="value">
	       <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
	      <![CDATA[
	          "EVENTS_DEVPRODUCT" = #type#
	      ]]>
		</isNotEmpty>
		)
		)temp
		GROUP BY "EVENTS_TARGETPORT"
		ORDER BY 'count' DESC
	</select>
	
	<!-- 主机类认证成功 -->
   <select id="sqlServerqueryServer.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT TOP 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>
	
	<!-- 主机类认证失败 -->
	 <select id="sqlServerqueryServer.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>
	
	<!-- 主机类认证成功来源地址统计 -->
     <select id="sqlServerqueryServerSuccess.countByIp" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"EVENTS_SOURCEADDT" AS 'key' FROM
		"tbl_server_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "EVENTS_SOURCEADDT"
		ORDER BY 'count' DESC
	</select>
	
	<!-- 防火墙类认证成功 -->
    <select id="sqlServerqueryFirewall.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>
	
	 <select id="sqlServerqueryFirewall.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT  top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_firewall_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>
	
    <!-- 网络设备认证成功 -->
   <select id="sqlServerqueryNetwork.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>
    
    <!-- 网络设备认证失败 -->
	<select id="sqlServerqueryNetwork.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT top 5 sum("EVENTS_NUMBER") AS 'count',"REL_ASSET_NAME" AS 'key' FROM
		"tbl_network_equipment_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY 'count' DESC
	</select>
	
	
    
     <!-- 入侵检测系统认证成功 -->
    <select id="sqlServerqueryIntrusionDetection.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
    
    <!-- 入侵检测事件认证失败 -->
	
	 <select id="sqlServerqueryIntrusionDetection.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_detection_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
    <!-- 入侵防御系统事件认证成功 -->
     <select id="sqlServerqueryIntrusionDefense.accountSuccess" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>
	
    
    <!-- 入侵防御系统事件认证失败 -->
	 <select id="sqlServerqueryIntrusionDefense.accountFail" resultClass="java.util.HashMap"
		parameterClass="java.util.HashMap">
		SELECT sum("EVENTS_NUMBER") AS "count","REL_ASSET_NAME" AS "key" FROM
		"tbl_intrusion_defense_events" WHERE 1 = 1
		<isNotEmpty prepend="AND" property="value">
        <![CDATA[
           "EVENTS_PUTTIME" > #value#
        ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="type">
         <![CDATA[
            "EVENTS_TYPE" = #type#
         ]]>
		</isNotEmpty>
		GROUP BY "REL_ASSET_NAME"
		ORDER BY "count" DESC
		LIMIT 5 OFFSET 0
	</select>

	<!-- 监控管理完毕 -->

	<!-- 认证失败 -->
	<select id="sqlServerquery.attestationFailde" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_attestation_failde"
		WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_attestation_failde")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		ORDER BY "EVENTS_TYPE" ASC
	</select>


	<!--查询资源耗尽总条数 -->
	<select id="sqlServerqueryeventsCM.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (SELECT "EVENTS_ID" FROM
		"tbl_CPU_depletion" WHERE "EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID" FROM "tbl_memory_depletion" WHERE
		"EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_memory_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		) FS WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- cpu总条数 -->
	<select id="sqlServerqueryeventsCPU.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_CPU_depletion" WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 内存总条数 -->
	<select id="sqlServerqueryeventsMemory.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_memory_depletion" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_memory_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 查询资源耗尽 -->
	<select id="sqlServerquery.depletion" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_CPU_depletion" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_CPU_depletion" )
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_memory_depletion"
		WHERE
		"EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_memory_depletion")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- CPU耗尽 -->
	<select id="sqlServerquery.cpudepletion" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_CPU_depletion" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_CPU_depletion")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 内存耗尽 -->
	<select id="sqlServerquery.memorydepletion" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT"EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_memory_depletion" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_memory_depletion")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 操作总条数 -->
	<select id="sqlServerqueryeventsOperation.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_related_operation" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_related_operation" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 操作 -->
	<select id="sqlServerquery.operation" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_related_operation" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_related_operation")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!--配置变更总条数 -->
	<select id="sqlServerqueryeventsConfig.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (SELECT "EVENTS_ID" FROM
		"tbl_configuration" WHERE "EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_configuration" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID" FROM "tbl_configurationerror" WHERE
		"EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_configurationerror" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		) FS WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 配置变更 -->
	<select id="sqlServerquery.config_ue" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configuration" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_configuration")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		"EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_configurationerror"
		WHERE
		"EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_configurationerror")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 配置变更总条数 -->
	<select id="sqlServerqueryeventsCU.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_configuration" WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM "tbl_configuration" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 配置变更 -->
	<select id="sqlServerquery.configuration" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configuration" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000
		"ID" FROM "tbl_configuration")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 配置变更总条数 -->
	<select id="sqlServerqueryeventsConfigError.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM "tbl_configurationerror" WHERE
		"EVENTS_ID" > (SELECT MAX("EVENTS_ID")-1000 "ID" FROM
		"tbl_configurationerror" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 配置错误 -->
	<select id="sqlServerquery.configerror" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configurationerror" WHERE "EVENTS_ID" >
		(SELECT
		MAX("EVENTS_ID")-1000 "ID" FROM "tbl_configurationerror")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 网络异常 -->
	<select id="sqlServerqueryAnomaly.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT count("EVENTS_ID") FROM "tbl_anomaly" WHERE "EVENTS_ID" >
		(SELECT MAX("EVENTS_ID")-1000 "ID" FROM "tbl_anomaly" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
		)
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 网络异常 -->
	<select id="sqlServerquery.anomaly" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME", "EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_anomaly" WHERE "EVENTS_ID" > (SELECT
		MAX("EVENTS_ID")-1000 "ID"
		FROM "tbl_anomaly")
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_TYPE" = #value# 
          ]]>
		</isNotEmpty>
	</select>


	<!-- 近期事件 -->
	<select id="sqlServerquery.recent" resultMap="summaryEventsResult"
		parameterClass="java.util.HashMap">
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID" ,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_memory_depletion"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_configuration" WHERE
		1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_configurationerror"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_related_operation"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM "tbl_server_events" WHERE
		1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_abnormal_flow_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_antivirus_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_antivirus_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_antivirus_web_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[ 
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_application_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_authentication_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_content_filtering_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_database_audit_products_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_database_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_intermediate_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_intrusion_defense_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_intrusion_detection_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_net_brake_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_network_equipment_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_safety_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_terminal_security_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME","EVENTS_POLICY" FROM
		"tbl_vpn_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
	</select>

	<!-- 近期事件总条 数 -->
	<select id="sqlServerqueryRecent.count" resultClass="int" parameterClass="java.util.HashMap">
		SELECT COUNT("EVENTS_ID") FROM (
		   SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD", "EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE", "EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE", "EVENTS_SOURCEADDT",
		"EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION",
		"EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE",
		"EVENTS_DEVVENDOR", "EVENTS_DEVNAME", "EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM "tbl_CPU_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_memory_depletion" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configuration" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_configurationerror" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_related_operation" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME", "EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT",
		"EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" ,
		"REL_LOG_TABLE_NAME" FROM
		"tbl_server_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_abnormal_flow_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_antivirus_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_antivirus_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_antivirus_web_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_application_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_authentication_system_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_content_filtering_gateway_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_database_audit_products_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_database_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_firewall_events"
		WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_intermediate_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_intrusion_defense_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1", "EVENTS_RAWID"
		,"REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_intrusion_detection_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_net_brake_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_network_equipment_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_resistance_refuse_server_attack_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_safety_device_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_terminal_security_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		UNION ALL
		SELECT "EVENTS_ID", "EVENTS_LEVEL", "EVENTS_NAME",
		"EVENTS_SOURCEADD",
		"EVENTS_SOURCEPORT", "EVENTS_TARGETADD",
		"EVENTS_TARGETPORT",
		"EVENTS_NUMBER", "EVENTS_SOURCE",
		"EVENTS_PUTTIME",
		"EVENTS_TABLE_TYPE",
		"EVENTS_TYPE",
		"EVENTS_SOURCEADDT", "EVENTS_TARGETADDT", "EVENTS_BEGINTIME",
		"EVENTS_LOG_IDENTIFICATION", "EVENTS_DEVPRODUCT", "EVENTS_PROGRAM",
		"EVENTS_DEVTYPE", "EVENTS_DEVVENDOR", "EVENTS_DEVNAME",
		"EVENTS_PROGRAMTYPE",
		"EVENTS_CUSTOMD1",
		"EVENTS_RAWID","REL_ASSET_NAME" , "REL_LOG_TABLE_NAME" FROM
		"tbl_vpn_events" WHERE 1=1
		<isNotEmpty prepend="AND" property="value">
          <![CDATA[
            "EVENTS_PUTTIME" >= #value# 
          ]]>
		</isNotEmpty>
		)R
	</select>


	<!-- 查询关联分析总条数 -->
	<select id="sqlServerRelevanceAnalysis_cache.count" resultClass="int"
		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM cache_relevance_analysis WHERE
		"REL_IDENTIFICATION" =
		CAST(#relId# AS bigint)
	</select>

	<!-- 查询关联分析cache表 -->
	<select id="sqlServerquery.RelevanceAnalysis_cache" resultClass="java.util.HashMap"
		parameterClass="Long">
		SELECT "LOG_IDENTIFICATION", "LOG_TYPE", "LOG_NAME",
		"LOG_RAWID",
		"LOG_PROGRAMTYPE",
		"LOG_DEVTYPE", "LOG_ACTION",
		"LOG_CUSTOMS2", "LOG_MSG", "LOG_DEVVENDOR",
		"LOG_RESOURCE",
		"LOG_DEVPRODUCT", "LOG_RESULT", "LOG_SYSTYPE",
		"LOG_PROGRAM",
		"LOG_PRIORITY", "LOG_SADDR", "LOG_SPORT", "LOG_DADDR",
		"LOG_DPORT",
		"LOG_AGGREGATED_COUNT", "LOG_SENDTIME",
		"REL_IDENTIFICATION","TABLE_NAME"
		FROM cache_relevance_analysis WHERE
		"REL_IDENTIFICATION" = #relId# ORDER
		BY "REL_IDENTIFICATION" DESC
	</select>

	<select id="sqlServerquery.protocol" resultClass="java.util.HashMap">
		SELECT "ID", "ObjID",
		"ObjType", "Name", "Alias", "Protocol", "Port",
		"Comment"
		FROM
		"tbl_dynamicservice";
	</select>
	
	<!-- 显示本天的最新的1000条数据 -->
	  <select id="sqlServerquery.recentEvents" parameterClass="java.util.HashMap" resultMap="eventsLogResult">
	        SELECT * FROM 
	     (SELECT
	     
	      <isEmpty property="flag">
	         TOP 1000
	    </isEmpty> 
	      
	     * FROM $tableName$ WHERE 1 = 1

	    <isNotEmpty property="priority" prepend="AND">
	      <![CDATA[
	        "LOG_PRIORITY" = #priority#
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="devproduct" prepend="AND">
	     <![CDATA[
	        "LOG_DEVPRODUCT" LIKE '%$devproduct$%'
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="type" prepend="AND">
	     <![CDATA[
	        "LOG_TYPE" = '$type$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty property="category" prepend="AND">
	       <![CDATA[
	          "LOG_CATEGORY" = '$category$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="highrank">
	    	"LOG_PRIORITY" in ($highrank$)
	    </isNotEmpty>
	        <isNotEmpty prepend="AND" property="assetId">
         <![CDATA[

            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsLogIdentifications">
	         "LOG_IDENTIFICATION" in $eventsLogIdentifications$
	    </isNotEmpty>
	       ORDER BY LOG_RECEPT_TIME DESC) t
	  </select> 
	  
	  
	 <!-- 修改增加高级查询条件 -->
	  <select id="sqlServerquery.recentEventsCount" parameterClass="java.util.HashMap" resultClass="int">
	     SELECT COUNT("LOG_ID") FROM 
	     (SELECT
	    <isEmpty property="flag">
	         TOP 1000
	    </isEmpty> 
	      * FROM $tableName$ WHERE 1 = 1
	         <isNotEmpty property="priority" prepend="AND">
	      <![CDATA[
	        "LOG_PRIORITY" = #priority#
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="devproduct" prepend="AND">
	     <![CDATA[
	        "LOG_DEVPRODUCT" LIKE '%$devproduct$%'
	        ]]>
	    </isNotEmpty>	
	    <isNotEmpty property="type" prepend="AND">
	     <![CDATA[
	        "LOG_TYPE" = '$type$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty property="category" prepend="AND">
	       <![CDATA[
	          "LOG_CATEGORY" = '$category$'
	       ]]>
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="highrank">
	    	"LOG_PRIORITY" in ($highrank$)
	    </isNotEmpty>
	        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="eventsLogIdentifications">
	         "LOG_IDENTIFICATION" in $eventsLogIdentifications$
	    </isNotEmpty>
	    ORDER BY LOG_ID ) t
	  </select>
	  
	  
	  
	<select id="sqlServerquery.event.definition" resultClass="java.util.HashMap">
		SELECT "ID", "NAME", "TYPE"
		FROM
		"tbl_event_definition"
	</select>
	<select id="sqlServerquery.existsTable" parameterClass="String"
		resultClass="int">
		 select count(*) from sys.objects where name= #value#
	</select>
 <!-- 查看本天的未 定义事件 -->
	 <select id="sqlServerquery.undefinedEventsCount" parameterClass="java.util.HashMap" resultClass="int">
	      SELECT COUNT(*) FROM $tableName$ WHERE 1 = 1
	        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
	 </select>
	 
	 <select id="sqlServerquery.undefinedEvents" parameterClass="java.util.HashMap" resultMap="eventsLogResult">
	      SELECT * FROM $tableName$ WHERE 1 = 1 
	        <isNotEmpty prepend="AND" property="assetId">
          <![CDATA[
            "LOG_ASSET_ID" in ($assetId$) 
          ]]>
		</isNotEmpty>
	       ORDER BY "LOG_ID" DESC
	  </select> 
	  
	  <!-- 自定义监控图表 -->
	  <select id="sqlServercustomMonitor.query" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" >
	    select TOP $topN$ "key",sum("count") as 'count'  from  
($sql$)
as e group by "key" order by 'count' desc 
	        
	  </select> 
</sqlMap>