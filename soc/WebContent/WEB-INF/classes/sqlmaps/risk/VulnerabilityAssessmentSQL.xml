<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="VulnerabilityAssessmentSQL">

	<resultMap id="VulnerabilityAssessmentId" 	class="VulnerabilityAssessment">
   		<result property="vulnerabilityAssessmentId" 				column="VAID" 		    		jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentAssetNo"       		column="VAASSETNO"       	    jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentAssetName"      	column="VAASSETNAME"          	jdbcType="varchar"/>
   		<result property="vulnerabilityAssessmentIp"      			column="VAIP"          			jdbcType="varchar"/>
   		<result property="vulnerabilityAssessmentEmergencyRisk"      column="VAEMERGENCYRISK"	    jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentSeniorRisk"      	column="VASENIORRISK"          	jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentIntermediateRisk"  	column="VAINTERMEDIATERISK"     jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentLlowerRisk"  	    column="VALLOWERRISK"     	    jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentIinformationRisk"  	column="VAIINFORMATIONRISK"     jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentRiskValue"  	    column="VARISKVALUE"     	    jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentRiskLevels"  	    column="VARISKLEVELS"     	    jdbcType="bigint"/>
   		<result property="vulnerabilityAssessmentVulnerabilityValue" column="VAVULNERABILITYVALUE"   jdbcType="bigint"/>
   		<result property="isdelete" column="IS_DELETE" jdbcType="bigint"/>
   	</resultMap>
   	
	<select id="pgAdmincountPage.VA"  parameterClass="java.util.HashMap" resultClass="int">
		SELECT COUNT(*) FROM "tbl_risk_vulnerabilityassessment" where 1=1 and "IS_DELETE"=1
		
		<isNotEmpty prepend= "AND"  property="keyword">
			<![CDATA[
				"VAASSETNAME" LIKE '%$keyword$%' or "VAIP" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vAAssetName">
			<![CDATA[
				"VAASSETNAME" LIKE '%$vAAssetName$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vARiskAbility">
			<![CDATA[
				"VAVULNERABILITYVALUE"=#vARiskAbility#
			]]>
		</isNotEmpty>
		<isNotEmpty prepend= "AND"  property="vARiskIp">
			<![CDATA[
				"VAIP" = '$vARiskIp$'
			]]>
		</isNotEmpty>
		 <isNotEmpty prepend= "AND"  property="vaip">
			<![CDATA[
				"VAIP" in ($vaip$)
			]]>
		</isNotEmpty> 
	</select>
	
	<select id="pgAdminVA.query"  parameterClass="java.util.HashMap" resultMap="VulnerabilityAssessmentId">
		SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1 and "IS_DELETE"=1
		
		<isNotEmpty prepend= "AND"  property="keyword">
			<![CDATA[
				"VAASSETNAME" LIKE '%$keyword$%' or "VAIP" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vAAssetName">
			<![CDATA[
				"VAASSETNAME" LIKE '%$vAAssetName$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vARiskAbility">
			<![CDATA[
				"VAVULNERABILITYVALUE" = #vARiskAbility#
			]]>
		</isNotEmpty>
		<isNotEmpty prepend= "AND"  property="vARiskIp">
			<![CDATA[
				"VAIP" = '$vARiskIp$'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend= "AND"  property="vaip">
			<![CDATA[
				"VAIP" in ($vaip$)
			]]>
		</isNotEmpty>
	</select>
	
	<insert id="pgAdmininsert.VA" parameterClass="VulnerabilityAssessment">
		INSERT INTO "tbl_risk_vulnerabilityassessment" 
				( 
				  "VAASSETNO",
				  "VAASSETNAME",
				  "VAIP",
				  "VAEMERGENCYRISK",
				  "VASENIORRISK",
				  "VAINTERMEDIATERISK",
				  "VALLOWERRISK",
				  "VAIINFORMATIONRISK",
				  "VARISKVALUE",
				  "VARISKLEVELS",
				  "VAVULNERABILITYVALUE",
				  "IS_DELETE"
				  )	
				  
				  VALUES 
				( 
				  #vulnerabilityAssessmentAssetNo#, 
				  #vulnerabilityAssessmentAssetName#,
				  #vulnerabilityAssessmentIp#,
				  #vulnerabilityAssessmentEmergencyRisk#,
				  #vulnerabilityAssessmentSeniorRisk#,
				  #vulnerabilityAssessmentIntermediateRisk#,
				  #vulnerabilityAssessmentLlowerRisk#,
				  #vulnerabilityAssessmentIinformationRisk#,
				  #vulnerabilityAssessmentRiskValue#,
				  #vulnerabilityAssessmentRiskLevels#,
				  #vulnerabilityAssessmentVulnerabilityValue#,1)
	</insert>
	
	<select id="pgAdminVA.sort" parameterClass="java.lang.String" resultMap="VulnerabilityAssessmentId">
	   SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1 ORDER BY $str$
	</select>
	<!-- 根据Ip查询资产 -->
	<select id="pgAdminquery.vaIp" parameterClass="java.util.HashMap" resultMap="VulnerabilityAssessmentId">
			SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1 and "IS_DELETE"=1
			
		<isNotEmpty prepend= "AND"  property="keyword">
			<![CDATA[
				"VAIP" = '$keyword$'
				
			]]>
		</isNotEmpty>
	   
	</select>
	<!-- 根据Ip查询资产 -->
	<select id="pgAdminquery.vaassetNo" parameterClass="java.util.HashMap" resultMap="VulnerabilityAssessmentId">
			SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1
			
		<isNotEmpty prepend= "AND"  property="assetNo">
			<![CDATA[
				"VAASSETNO" = #assetNo#
			]]>
		</isNotEmpty>
	   
	</select>
	<!-- 根据资产ip修改关联的脆弱性值状态 -->
   		<update id="pgAdminupdate.VAStates" parameterClass="java.util.HashMap">
   		<![CDATA[
   			UPDATE "tbl_risk_vulnerabilityassessment"
   			SET
				 "IS_DELETE" = #assetStatus#	
			WHERE "VAIP" = #vAIp#  
				  
   		]]>
   	</update>
	<!-- 根据ip修改脆弱性值 -->
   		<update id="pgAdminupdate.VAByVaIp" parameterClass="VulnerabilityAssessment">
   		<![CDATA[
   			UPDATE "tbl_risk_vulnerabilityassessment"
   			SET
				  "VAASSETNO"=#vulnerabilityAssessmentAssetNo#,
				  "VAASSETNAME"= #vulnerabilityAssessmentAssetName#,
				  "VAEMERGENCYRISK"=#vulnerabilityAssessmentEmergencyRisk#,
				  "VASENIORRISK"=#vulnerabilityAssessmentSeniorRisk#,
				  "VAINTERMEDIATERISK"=#vulnerabilityAssessmentIntermediateRisk#,
				  "VALLOWERRISK"=#vulnerabilityAssessmentLlowerRisk#,
				  "VAIINFORMATIONRISK"=#vulnerabilityAssessmentIinformationRisk#,
				  "VARISKVALUE"=#vulnerabilityAssessmentRiskValue#,
				  "VARISKLEVELS"=#vulnerabilityAssessmentRiskLevels#,
				  "VAVULNERABILITYVALUE"= #vulnerabilityAssessmentVulnerabilityValue#
				
			WHERE "VAIP" = #vulnerabilityAssessmentIp#  
   		]]>
   	</update>
   	
   	<!-- sqlServer -->
   	<select id="sqlServercountPage.VA"  parameterClass="java.util.HashMap" resultClass="int">
		SELECT COUNT(*) FROM "tbl_risk_vulnerabilityassessment" where 1=1 and "IS_DELETE"=1
		
		<isNotEmpty prepend= "AND"  property="keyword">
			<![CDATA[
				"VAASSETNAME" LIKE '%$keyword$%' or "VAIP" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vAAssetName">
			<![CDATA[
				"VAASSETNAME" LIKE '%$vAAssetName$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vARiskAbility">
			<![CDATA[
				"VAVULNERABILITYVALUE"=#vARiskAbility#
			]]>
		</isNotEmpty>
		<isNotEmpty prepend= "AND"  property="vARiskIp">
			<![CDATA[
				"VAIP" = '$vARiskIp$'
			]]>
		</isNotEmpty>
		 <isNotEmpty prepend= "AND"  property="vaip">
			<![CDATA[
				"VAIP" in ($vaip$)
			]]>
		</isNotEmpty> 
	</select>
	
	<select id="sqlServerVA.query"  parameterClass="java.util.HashMap" resultMap="VulnerabilityAssessmentId">
		SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1 and "IS_DELETE"=1
		
		<isNotEmpty prepend= "AND"  property="keyword">
			<![CDATA[
				"VAASSETNAME" LIKE '%$keyword$%' or "VAIP" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vAAssetName">
			<![CDATA[
				"VAASSETNAME" LIKE '%$vAAssetName$%'
			]]>
		</isNotEmpty>
		
		<isNotEmpty prepend= "AND"  property="vARiskAbility">
			<![CDATA[
				"VAVULNERABILITYVALUE" = #vARiskAbility#
			]]>
		</isNotEmpty>
		<isNotEmpty prepend= "AND"  property="vARiskIp">
			<![CDATA[
				"VAIP" = '$vARiskIp$'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend= "AND"  property="vaip">
			<![CDATA[
				"VAIP" in ($vaip$)
			]]>
		</isNotEmpty>
	</select>
	
	<insert id="sqlServerinsert.VA" parameterClass="VulnerabilityAssessment">
		INSERT INTO "tbl_risk_vulnerabilityassessment" 
				( 
				  "VAASSETNO",
				  "VAASSETNAME",
				  "VAIP",
				  "VAEMERGENCYRISK",
				  "VASENIORRISK",
				  "VAINTERMEDIATERISK",
				  "VALLOWERRISK",
				  "VAIINFORMATIONRISK",
				  "VARISKVALUE",
				  "VARISKLEVELS",
				  "VAVULNERABILITYVALUE",
				  "IS_DELETE"
				  )	
				  
				  VALUES 
				( 
				  #vulnerabilityAssessmentAssetNo#, 
				  #vulnerabilityAssessmentAssetName#,
				  #vulnerabilityAssessmentIp#,
				  #vulnerabilityAssessmentEmergencyRisk#,
				  #vulnerabilityAssessmentSeniorRisk#,
				  #vulnerabilityAssessmentIntermediateRisk#,
				  #vulnerabilityAssessmentLlowerRisk#,
				  #vulnerabilityAssessmentIinformationRisk#,
				  #vulnerabilityAssessmentRiskValue#,
				  #vulnerabilityAssessmentRiskLevels#,
				  #vulnerabilityAssessmentVulnerabilityValue#,1)
	</insert>
	
	<select id="sqlServerVA.sort" parameterClass="java.lang.String" resultMap="VulnerabilityAssessmentId">
	   SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1 ORDER BY $str$
	</select>
	<!-- 根据Ip查询资产 -->
	<select id="sqlServerquery.vaIp" parameterClass="java.util.HashMap" resultMap="VulnerabilityAssessmentId">
			SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1 and "IS_DELETE"=1
			
		<isNotEmpty prepend= "AND"  property="keyword">
			<![CDATA[
				"VAIP" = '$keyword$'
				
			]]>
		</isNotEmpty>
	   
	</select>
	<!-- 根据Ip查询资产 -->
	<select id="sqlServerquery.vaassetNo" parameterClass="java.util.HashMap" resultMap="VulnerabilityAssessmentId">
			SELECT * FROM "tbl_risk_vulnerabilityassessment" where 1=1
			
		<isNotEmpty prepend= "AND"  property="assetNo">
			<![CDATA[
				"VAASSETNO" = #assetNo#
			]]>
		</isNotEmpty>
	   
	</select>
	<!-- 根据资产ip修改关联的脆弱性值状态 -->
   		<update id="sqlServerupdate.VAStates" parameterClass="java.util.HashMap">
   		<![CDATA[
   			UPDATE "tbl_risk_vulnerabilityassessment"
   			SET
				 "IS_DELETE" = #assetStatus#	
			WHERE "VAIP" = #vAIp#  
				  
   		]]>
   	</update>
	<!-- 根据ip修改脆弱性值 -->
   		<update id="sqlServerupdate.VAByVaIp" parameterClass="VulnerabilityAssessment">
   		<![CDATA[
   			UPDATE "tbl_risk_vulnerabilityassessment"
   			SET
				  "VAASSETNO"=#vulnerabilityAssessmentAssetNo#,
				  "VAASSETNAME"= #vulnerabilityAssessmentAssetName#,
				  "VAEMERGENCYRISK"=#vulnerabilityAssessmentEmergencyRisk#,
				  "VASENIORRISK"=#vulnerabilityAssessmentSeniorRisk#,
				  "VAINTERMEDIATERISK"=#vulnerabilityAssessmentIntermediateRisk#,
				  "VALLOWERRISK"=#vulnerabilityAssessmentLlowerRisk#,
				  "VAIINFORMATIONRISK"=#vulnerabilityAssessmentIinformationRisk#,
				  "VARISKVALUE"=#vulnerabilityAssessmentRiskValue#,
				  "VARISKLEVELS"=#vulnerabilityAssessmentRiskLevels#,
				  "VAVULNERABILITYVALUE"= #vulnerabilityAssessmentVulnerabilityValue#
				
			WHERE "VAIP" = #vulnerabilityAssessmentIp#  
   		]]>
   	</update>
   	
   	
</sqlMap>