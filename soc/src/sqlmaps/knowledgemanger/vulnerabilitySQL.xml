<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="vulnerabilitySQL">

	<resultMap id="vulnerabilityResult" class="vulnerability">
		<result property="vulnerabilityId" column="VULNERABILITY_ID"

			jdbcType="bigint" />
		<result property="vulnerabilityUniqueIdentification" column="VULNERABILITY_UNIQUE_IDENTIFICATION"
			jdbcType="varchar" />
		<result property="vulnerabilityName" column="VULNERABILITY_NAME"
			jdbcType="varchar" />
		<result property="vulnerabilitySynopsis" column="VULNERABILITY_SYNOPSIS"
			jdbcType="text" />
		<result property="vulnerabilitySolution" column="VULNERABILITY_SOLUTION"
			jdbcType="text" />
		<result property="vulnerabilitySeeAlso" column="VULNERABILITY_SEE_ALSO"
			jdbcType="text" />
		<result property="vulnerabilityType" column="VULNERABILITY_TYPE"
			jdbcType="varchar" />
		<result property="vulnerabilityRiskFactor" column="VULNERABILITY_RISK_FACTOR"
			jdbcType="varchar" />
		<result property="vulnerabilityUpdateDateTime" column="VULNERABILITY_UPDATE_DATE_TIME"
			jdbcType="varchar" />
		<result property="vulnerabilityCvssMath" column="VULNERABILITY_CVSS_MATH"
			jdbcType="varchar" />
		<result property="vulnerabilityCveID" column="VULNERABILITY_CVE_ID"
			jdbcType="varchar" />
		<result property="vulnerabilityPluginPublicationDateTime"

			column="VULNERABILITY_PLUGIN_PUBLICATION_DATE_TIME" jdbcType="varchar" />
		<result property="vulnerabilityPluginLastModificationDateTime"

			column="VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" jdbcType="date" />
		<result property="vulnerabilityAttack" column="VULNERABILITY_ATTACK"
			jdbcType="longtext" />
		<result property="vulnerabilityPort" column="VULNERABILITY_PORT"
			jdbcType="varchar" />
		<result property="vulnerabilityService" column="VULNERABILITY_SERVICE"
			jdbcType="varchar" />
		<result property="vulnerabilityIsDelete" column="VULNERABILITY_IS_DELETE"
			jdbcType="integer" />
		<result property="vulnerabilityMemo" column="VULNERABILITY_MEMO"
			jdbcType="text" />
		<result property="vulnerabilityOid" column="VULNERABILITY_OID"
			jdbcType="varchar" />
		<result property="vulnerabilityVersion" column="VULNERABILITY_VERSION"
			jdbcType="varchar" />
		<result property="vulnerabilityCopyright" column="VULNERABILITY_COPYRIGHT"
			jdbcType="varchar" />
		<result property="vulnerabilityTag" column="VULNERABILITY_TAG"
			jdbcType="varchar" />
		<result property="vulnerabilityDependencies" column="VULNERABILITY_DEPENDENCIES"
			jdbcType="varchar" />
		<result property="vulnerabilityRequiredKeys" column="VULNERABILITY_REQUIRED_KEYS"
			jdbcType="varchar" />
		<result property="vulnerabilityMandatorgKeys" column="VULNERABILITY_MANDATORG_KEYS"
			jdbcType="varchar" />
		<result property="vulnerabilityExcluedKeys" column="VULNERABILITY_EXCLUED_KEYS"
			jdbcType="varchar" />
		<result property="vulnerabilitySignKeyIds" column="VULNERABILITY_SIGN_KEY_IDS"
			jdbcType="varchar" />
		<result property="vulnerabilityAsc" column="VULNERABILITY_ASC"
			jdbcType="varchar" />
		<result property="vulnerabilityNvtiSrc" column="VULNERABILITY_NVTI_SRC"
			jdbcType="varchar" />
		<result property="vulnerabilityCheckType" column="VULNERABILITY_CHECK_TYPE"
			jdbcType="varchar" />
		<result property="vulnerabilityCvssBase" column="VULNERABILITY_CVSS_BASE"
			jdbcType="varchar" />
		<result property="vulnerabilityPrefs" column="VULNERABILITY_PREFS"
			jdbcType="varchar" />
		<result property="vulnerabilityTimeout" column="VULNERABILITY_TIMEOUT"
			jdbcType="varchar" />
		<result property="vulnerabilityAscFileName" column="VULNERABILITY_ASC_FILENAME"
			jdbcType="varchar" />
	</resultMap>
	<resultMap class="vulnerability" id="vulnerabilityResult1">
		<result property="vulnerabilityUniqueIdentification" column="VULNERABILITY_UNIQUE_IDENTIFICATION"
			jdbcType="varchar" />
	</resultMap>
	<resultMap class="vulnerability" id="vulnerabilityResult2">
		<result property="vulnerabilityType" column="VULNERABILITY_TYPE"
			jdbcType="varchar" />
	</resultMap>
	<!-- 查询条数 -->
	<select id="pgAdminvulnerability.count" resultClass="int"

		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM tbl_vulnerability WHERE
		"VULNERABILITY_IS_DELETE" = 0
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_SYNOPSIS"  

LIKE '%$keyword$%') 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityUniqueIdentification">
			<![CDATA[
				"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%

$selvulnerabilityUniqueIdentification$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				"VULNERABILITY_NAME" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityType">
			<![CDATA[
				"VULNERABILITY_TYPE" LIKE '%$selvulnerabilityType$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityRiskFactor">
			<![CDATA[
				"VULNERABILITY_RISK_FACTOR" LIKE '%

$selvulnerabilityRiskFactor$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilitySynopsis">
			<![CDATA[
				"VULNERABILITY_SYNOPSIS" LIKE '%$selvulnerabilitySynopsis$%'
			]]>
		</isNotEmpty>
	</select>
	<!-- 高级查询 (默认不显示系统内置用户) -->
	<select id="pgAdminvulnerability.query" parameterClass="java.util.HashMap"

		resultMap="vulnerabilityResult">
		SELECT * FROM tbl_vulnerability WHERE 1=1 and
		"VULNERABILITY_IS_DELETE"=0
		<!-- <isNotEmpty prepend= "AND" property="display"> <![CDATA[ "vulnerabilityIsDelete 
			= #display# ]]> </isNotEmpty> -->
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_SYNOPSIS"  

LIKE '%$keyword$%') 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityUniqueIdentification">
			<![CDATA[
				"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$selvulnerabilityUniqueIdentification$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				"VULNERABILITY_NAME" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityType">
			<![CDATA[
				"VULNERABILITY_TYPE" LIKE '%$selvulnerabilityType$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityRiskFactor">
			<![CDATA[
				"VULNERABILITY_RISK_FACTOR" LIKE '%$selvulnerabilityRiskFactor$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilitySynopsis">
			<![CDATA[
				"VULNERABILITY_SYNOPSIS" LIKE '%$selvulnerabilitySynopsis$%'
			]]>
		</isNotEmpty>
		ORDER BY "VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" DESC

	</select>
	<!-- 查询出所有漏洞id -->
	<select id="pgAdminvulnerability.queryVulnerabilityId" resultClass="java.util.HashMap">
		SELECT VULNERABILITY_ID,VULNERABILITY_TYPE FROM tbl_vulnerability
		WHERE

		VULNERABILITY_IS_DELETE = 0
	</select>
	<!-- 查询出所有符合条件的漏洞信息 -->
	<select id="pgAdminvulnerability.queryAllVulnerabilityBasic"

		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "VULNERABILITY_ID","VULNERABILITY_NAME","VULNERABILITY_TYPE"
		FROM

		tbl_vulnerability WHERE 1=1 and "VULNERABILITY_IS_DELETE" = 0
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_MEMO"  LIKE 

'%$keyword$%') 
			]]>
		</isNotEmpty>
	</select>
	<!-- 根据漏洞ID查询 -->
	<select id="pgAdminvulnerability.queryById" parameterClass="long"

		resultMap="vulnerabilityResult">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</select>
	<!-- 根据账户ID查询 -->
	<select id="pgAdminvulnerability.queryTypeById" parameterClass="long"

		resultClass="java.lang.String">
		<![CDATA[
			SELECT distinct "VULNERABILITY_TYPE" FROM tbl_vulnerability WHERE 

"VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</select>
	<!-- 查询漏洞信息 -->
	<select id="pgAdminvulnerability.queryVulnerability" resultClass="java.util.HashMap"

		parameterClass="long">
		<![CDATA[
			SELECT "VULNERABILITY_ID","VULNERABILITY_NAME","VULNERABILITY_TYPE" 

FROM tbl_vulnerability WHERE "VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</select>
	<!-- 导出Excel表 -->
	<select id="pgAdminvulnerability.export" resultClass="java.util.HashMap"

		parameterClass="java.util.HashMap">
		SELECT * FROM tbl_vulnerability WHERE "VULNERABILITY_IS_DELETE" = 0
		<isNotEmpty prepend="AND" property="ids">
			"VULNERABILITY_ID"
			in($ids$)
		</isNotEmpty>
		
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_SYNOPSIS"  

LIKE '%$keyword$%') 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityUniqueIdentification">
			<![CDATA[
				"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$selvulnerabilityUniqueIdentification$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				"VULNERABILITY_NAME" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityType">
			<![CDATA[
				"VULNERABILITY_TYPE" LIKE '%$selvulnerabilityType$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityRiskFactor">
			<![CDATA[
				"VULNERABILITY_RISK_FACTOR" LIKE '%

$selvulnerabilityRiskFactor$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilitySynopsis">
			<![CDATA[
				"VULNERABILITY_SYNOPSIS" LIKE '%$selvulnerabilitySynopsis$%'
			]]>
		</isNotEmpty>
	</select>

	<!-- 根据漏洞类型查询 -->
	<select id="pgAdminvulnerability.queryType" parameterClass="java.lang.String"

		resultMap="vulnerabilityResult">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_TYPE"=#vulnerabilityType#
		]]>
	</select>
	<!-- 根据漏洞类型查询第一条漏洞信息 -->
	<select id="pgAdminvulnerability.queryFirstByType" parameterClass="java.lang.String"

		resultMap="vulnerabilityResult">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_TYPE"=#vulnerabilityType# LIMIT 0,1
		]]>
	</select>
	<!-- 根据漏洞类型查询只显示漏洞id,漏洞名 -->
	<select id="pgAdminvulnerability.queryByType" parameterClass="java.lang.String"

		resultClass="java.util.HashMap">
		<![CDATA[
			SELECT "VULNERABILITY_ID","VULNERABILITY_NAME","VULNERABILITY_TYPE" 

FROM tbl_vulnerability WHERE "VULNERABILITY_TYPE"=#vulnerabilityType#
		]]>
	</select>
	<select id="pgAdminvulnerability.countByType" parameterClass="java.lang.String"

		resultClass="int">
		SELECT COUNT(*) FROM tbl_vulnerability WHERE

		VULNERABILITY_TYPE=#vulnerabilityType#
	</select>
	<!--添加漏洞 -->
	<insert id="pgAdminvulnerability.insert" parameterClass="java.util.HashMap">
		INSERT INTO
		"tbl_vulnerability"
		(
		"VULNERABILITY_UNIQUE_IDENTIFICATION",
		"VULNERABILITY_NAME",
		"VULNERABILITY_SYNOPSIS",
		"VULNERABILITY_SOLUTION",
		"VULNERABILITY_SEE_ALSO",
		"VULNERABILITY_TYPE",
		"VULNERABILITY_RISK_FACTOR",
		"VULNERABILITY_UPDATE_DATE_TIME",
		"VULNERABILITY_CVSS_MATH",
		"VULNERABILITY_CVE_ID",
		"VULNERABILITY_PLUGIN_PUBLICATION_DATE_TIME",
		"VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME",
		"VULNERABILITY_ATTACK",
		"VULNERABILITY_PORT",
		"VULNERABILITY_SERVICE",
		"VULNERABILITY_MEMO",
		"VULNERABILITY_OID",
		"VULNERABILITY_VERSION",
		"VULNERABILITY_COPYRIGHT",
		"VULNERABILITY_TAG",
		"VULNERABILITY_DEPENDENCIES",
		"VULNERABILITY_REQUIRED_KEYS",
		"VULNERABILITY_MANDATORG_KEYS",
		"VULNERABILITY_EXCLUED_KEYS",
		"VULNERABILITY_SIGN_KEY_IDS",
		"VULNERABILITY_ASC",
		"VULNERABILITY_NVTI_SRC",
		"VULNERABILITY_CHECK_TYPE",
		"VULNERABILITY_CVSS_BASE",
		"VULNERABILITY_PREFS",
		"VULNERABILITY_TIMEOUT",
		"VULNERABILITY_ASC_FILENAME"
		)
		VALUES(
		#vulnerabilityUniqueIdentification#,
		#vulnerabilityName#,
		#vulnerabilitySynopsis#,
		#vulnerabilitySolution#,
		#vulnerabilitySeeAlso#,
		#vulnerabilityType#,
		#vulnerabilityRiskFactor#,
		#vulnerabilityUpdateDateTime#,
		#vulnerabilityCvssMath#,
		#vulnerabilityCveID#,
		#vulnerabilityPluginPublicationDateTime#,
		#vulnerabilityPluginLastModificationDateTime#,
		#vulnerabilityAttack#,
		#vulnerabilityPort#,
		#vulnerabilityService#,
		#vulnerabilityMemo#,
		#vulnerabilityOid#,
		#vulnerabilityVersion#,
		#vulnerabilityCopyright#,
		#vulnerabilityTag#,
		#vulnerabilityDependencies#,
		#vulnerabilityRequiredKeys#,
		#vulnerabilityMandatorgKeys#,
		#vulnerabilityExcluedKeys#,
		#vulnerabilitySignKeyIds#,
		#vulnerabilityAsc#,
		#vulnerabilityNvtiSrc#,
		#vulnerabilityCheckType#,
		#vulnerabilityCvssBase#,
		#vulnerabilityPrefs#,
		#vulnerabilityTimeout#,
		#vulnerabilityAscFileName#
		)
	</insert>

	<!-- 更新 -->
	<update id="pgAdminvulnerability.update" parameterClass="vulnerability">
		UPDATE
		tbl_vulnerability v
		SET
		"VULNERABILITY_UNIQUE_IDENTIFICATION" =

		#vulnerabilityUniqueIdentification#,
		"VULNERABILITY_NAME" =
		#vulnerabilityName#,
		"VULNERABILITY_SYNOPSIS" = #vulnerabilitySynopsis#,
		"VULNERABILITY_SOLUTION" = #vulnerabilitySolution#,
		"VULNERABILITY_SEE_ALSO" = #vulnerabilitySeeAlso#,
		"VULNERABILITY_TYPE" =
		#vulnerabilityType#,
		"VULNERABILITY_RISK_FACTOR" =

		#vulnerabilityRiskFactor#,
		"VULNERABILITY_UPDATE_DATE_TIME" =

		#vulnerabilityUpdateDateTime#,
		"VULNERABILITY_CVSS_MATH" =
		#vulnerabilityCvssMath#,
		"VULNERABILITY_CVE_ID"=#vulnerabilityCveID#,
		"VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" =

		#vulnerabilityPluginLastModificationDateTime#,
		"VULNERABILITY_ATTACK" =
		#vulnerabilityAttack#,
		"VULNERABILITY_PORT" = #vulnerabilityPort#,
		"VULNERABILITY_SERVICE" = #vulnerabilityService#,
		"VULNERABILITY_MEMO" =
		#vulnerabilityMemo#

		WHERE
		"VULNERABILITY_ID" = #vulnerabilityId#
	</update>
	<!-- 标记删除 -->
	<delete id="pgAdminvulnerability.delete" parameterClass="long">
		<![CDATA[
			UPDATE tbl_vulnerability SET "VULNERABILITY_IS_DELETE" = 1 WHERE 

"VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</delete>

	<!--清空漏洞信息表 -->
	<delete id="pgAdminvulnerability.delete2" parameterClass="long">
		<![CDATA[
		DELETE  from tbl_vulnerability
		]]>
	</delete>

	<!-- 根据漏洞编号查询 -->
	<select id="pgAdminvulnerability.queryVulnerabilityUniqueIdentification"

		parameterClass="java.lang.String" resultClass="vulnerability">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_UNIQUE_IDENTIFICATION"=#vulnerabilityUniqueIdentification#
		]]>
	</select>

	<!-- 查询所有的漏洞编号 -->
	<select id="pgAdminvulnerability.queryAllIdentification" resultMap="vulnerabilityResult1">
		SELECT "VULNERABILITY_UNIQUE_IDENTIFICATION" from tbl_vulnerability
	</select>

	<!-- 查询所有漏洞类型 -->
	<select id="pgAdminvulnerability.queryVulnerabilityType" resultMap="vulnerabilityResult2">
	  <![CDATA[
	     SELECT "VULNERABILITY_TYPE" FROM tbl_vulnerability GROUP BY  

"VULNERABILITY_TYPE" 
	  ]]>
	</select>

	<!-- 漏洞信息导入 -->
	<insert id="pgAdminvulnerability.importVulnerability" parameterClass="vulnerability">
	  <![CDATA[
	   INSERT INTO tbl_vulnerability
	   (
	              "VULNERABILITY_UNIQUE_IDENTIFICATION",
					"VULNERABILITY_NAME",
					"VULNERABILITY_SYNOPSIS",
					"VULNERABILITY_SOLUTION",
					"VULNERABILITY_SEE_ALSO", 
					"VULNERABILITY_TYPE",
					"VULNERABILITY_RISK_FACTOR",
					"VULNERABILITY_UPDATE_DATE_TIME",
					"VULNERABILITY_CVSS_MATH",
					"VULNERABILITY_CVE_ID",
					"VULNERABILITY_PLUGIN_PUBLICATION_DATE_TIME",
					"VULNERABILITY_ATTACK",
					"VULNERABILITY_PORT",
					"VULNERABILITY_SERVICE",
					"VULNERABILITY_MEMO",
					"VULNERABILITY_OID",
					"VULNERABILITY_VERSION",
					"VULNERABILITY_COPYRIGHT",
					"VULNERABILITY_TAG",
					"VULNERABILITY_DEPENDENCIES",
					"VULNERABILITY_REQUIRED_KEYS",
					"VULNERABILITY_MANDATORG_KEYS",
					"VULNERABILITY_EXCLUED_KEYS",
					"VULNERABILITY_SIGN_KEY_IDS",
					"VULNERABILITY_ASC",
					"VULNERABILITY_NVTI_SRC",
					"VULNERABILITY_CHECK_TYPE",
					"VULNERABILITY_CVSS_BASE",
					"VULNERABILITY_PREFS", 
					"VULNERABILITY_TIMEOUT",
					"VULNERABILITY_ASC_FILENAME"
	   )
	   VALUES(
	                #vulnerabilityUniqueIdentification#,
				    #vulnerabilityName#,
				    #vulnerabilitySynopsis#,
				    #vulnerabilitySolution#,
				    #vulnerabilitySeeAlso#,
				    #vulnerabilityType#,
				    #vulnerabilityRiskFactor#,
				    #vulnerabilityUpdateDateTime#,
				    #vulnerabilityCvssMath#,
				    #vulnerabilityCveID#,
				    #vulnerabilityPluginPublicationDateTime#,
				    #vulnerabilityAttack#,
				    #vulnerabilityPort#,
				    #vulnerabilityService#,
				    #vulnerabilityMemo#,
				    #vulnerabilityOid#,
				    #vulnerabilityVersion#,
				    #vulnerabilityCopyright#,
				    #vulnerabilityTag#,
				    #vulnerabilityDependencies#,
				    #vulnerabilityRequiredKeys#,
				    #vulnerabilityMandatorgKeys#,
				    #vulnerabilityExcluedKeys#,
				    #vulnerabilitySignKeyIds#,
				    #vulnerabilityAsc#,
				    #vulnerabilityNvtiSrc#,
				    #vulnerabilityCheckType#,
				    #vulnerabilityCvssBase#,
				    #vulnerabilityPrefs#,
				    #vulnerabilityTimeout#,
				    #vulnerabilityAscFileName#
	   )  
	  ]]>
	</insert>

	<!--漏洞导入修改 -->
	<update id="pgAdminvulnerability.updateimport" parameterClass="vulnerability">
		UPDATE
		tbl_vulnerability v
		SET
		"VULNERABILITY_NAME" = #vulnerabilityName#,
		"VULNERABILITY_SYNOPSIS" = #vulnerabilitySynopsis#,
		"VULNERABILITY_SOLUTION" = #vulnerabilitySolution#,
		"VULNERABILITY_SEE_ALSO" = #vulnerabilitySeeAlso#,
		"VULNERABILITY_TYPE" =
		#vulnerabilityType#,
		"VULNERABILITY_RISK_FACTOR" =

		#vulnerabilityRiskFactor#,
		"VULNERABILITY_UPDATE_DATE_TIME" =

		#vulnerabilityUpdateDateTime#,
		"VULNERABILITY_CVSS_MATH" =
		#vulnerabilityCvssMath#,
		"VULNERABILITY_CVE_ID"=#vulnerabilityCveID#,
		"VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" =

		#vulnerabilityPluginLastModificationDateTime#,
		"VULNERABILITY_ATTACK" =
		#vulnerabilityAttack#,
		"VULNERABILITY_PORT" = #vulnerabilityPort#,
		"VULNERABILITY_SERVICE" = #vulnerabilityService#,
		"VULNERABILITY_IS_DELETE"= #vulnerabilityIsDelete#,
		"VULNERABILITY_MEMO" =
		#vulnerabilityMemo#,
		"VULNERABILITY_OID" = #vulnerabilityOid#,
		"VULNERABILITY_VERSION" = #vulnerabilityVersion#,
		"VULNERABILITY_COPYRIGHT" = #vulnerabilityCopyright#,
		"VULNERABILITY_TAG" =
		#vulnerabilityTag#,
		"VULNERABILITY_DEPENDENCIES" =

		#vulnerabilityDependencies#,
		"VULNERABILITY_REQUIRED_KEYS" =

		#vulnerabilityRequiredKeys#,
		"VULNERABILITY_MANDATORG_KEYS" =

		#vulnerabilityMandatorgKeys#,
		"VULNERABILITY_EXCLUED_KEYS" =

		#vulnerabilityExcluedKeys#,
		"VULNERABILITY_SIGN_KEY_IDS" =

		#vulnerabilitySignKeyIds#,
		"VULNERABILITY_ASC" = #vulnerabilityAsc#,
		"VULNERABILITY_NVTI_SRC" = #vulnerabilityNvtiSrc#,
		"VULNERABILITY_CHECK_TYPE" = #vulnerabilityCheckType#,
		"VULNERABILITY_CVSS_BASE" = #vulnerabilityCvssBase#,
		"VULNERABILITY_PREFS"
		= #vulnerabilityPrefs#,
		"VULNERABILITY_TIMEOUT" = #vulnerabilityTimeout#,
		"VULNERABILITY_ASC_FILENAME" =

		#vulnerabilityAscFileName#
		WHERE
		"VULNERABILITY_UNIQUE_IDENTIFICATION" =

		#vulnerabilityUniqueIdentification#

	</update>
	<!-- 排序 -->
<select id="pgAdminvulnerability.sort" resultMap="vulnerabilityResult" parameterClass="java.lang.String">
      SELECT * FROM tbl_vulnerability ORDER BY $str$
</select>
<!-- sqlserver -->
<!-- 查询条数 -->
	<select id="sqlServervulnerability.count" resultClass="int"

		parameterClass="java.util.HashMap">
		SELECT COUNT(*) FROM tbl_vulnerability WHERE
		"VULNERABILITY_IS_DELETE" = 0
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%$keyword$%' 
OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_SYNOPSIS"  
LIKE '%$keyword$%') 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityUniqueIdentification">
			<![CDATA[
				"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$selvulnerabilityUniqueIdentification$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				"VULNERABILITY_NAME" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityType">
			<![CDATA[
				"VULNERABILITY_TYPE" LIKE '%$selvulnerabilityType$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityRiskFactor">
			<![CDATA[
				"VULNERABILITY_RISK_FACTOR" LIKE '%$selvulnerabilityRiskFactor$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilitySynopsis">
			<![CDATA[
				"VULNERABILITY_SYNOPSIS" LIKE '%$selvulnerabilitySynopsis$%'
			]]>
		</isNotEmpty>
	</select>
	<!-- 高级查询 (默认不显示系统内置用户) -->
	<select id="sqlServervulnerability.query" parameterClass="java.util.HashMap"

		resultMap="vulnerabilityResult">
		SELECT * FROM tbl_vulnerability WHERE 1=1 and
		"VULNERABILITY_IS_DELETE"=0
		<!-- <isNotEmpty prepend= "AND" property="display"> <![CDATA[ "vulnerabilityIsDelete 
			= #display# ]]> </isNotEmpty> -->
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_SYNOPSIS"  

LIKE '%$keyword$%') 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityUniqueIdentification">
			<![CDATA[
				"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$selvulnerabilityUniqueIdentification$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				"VULNERABILITY_NAME" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityType">
			<![CDATA[
				"VULNERABILITY_TYPE" LIKE '%$selvulnerabilityType$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityRiskFactor">
			<![CDATA[
				"VULNERABILITY_RISK_FACTOR" LIKE '%$selvulnerabilityRiskFactor$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilitySynopsis">
			<![CDATA[
				"VULNERABILITY_SYNOPSIS" LIKE '%$selvulnerabilitySynopsis$%'
			]]>
		</isNotEmpty>
		ORDER BY "VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" DESC

	</select>
	<!-- 查询出所有漏洞id -->
	<select id="sqlServervulnerability.queryVulnerabilityId" resultClass="java.util.HashMap">
		SELECT VULNERABILITY_ID,VULNERABILITY_TYPE FROM tbl_vulnerability
		WHERE

		VULNERABILITY_IS_DELETE = 0
	</select>
	<!-- 查询出所有符合条件的漏洞信息 -->
	<select id="sqlServervulnerability.queryAllVulnerabilityBasic"

		parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT "VULNERABILITY_ID","VULNERABILITY_NAME","VULNERABILITY_TYPE"
		FROM

		tbl_vulnerability WHERE 1=1 and "VULNERABILITY_IS_DELETE" = 0
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_MEMO"  LIKE 

'%$keyword$%') 
			]]>
		</isNotEmpty>
	</select>
	<!-- 根据漏洞ID查询 -->
	<select id="sqlServervulnerability.queryById" parameterClass="long"

		resultMap="vulnerabilityResult">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</select>
	<!-- 根据账户ID查询 -->
	<select id="sqlServervulnerability.queryTypeById" parameterClass="long"

		resultClass="java.lang.String">
		<![CDATA[
			SELECT distinct "VULNERABILITY_TYPE" FROM tbl_vulnerability WHERE 

"VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</select>
	<!-- 查询漏洞信息 -->
	<select id="sqlServervulnerability.queryVulnerability" resultClass="java.util.HashMap"

		parameterClass="long">
		<![CDATA[
			SELECT "VULNERABILITY_ID","VULNERABILITY_NAME","VULNERABILITY_TYPE" 

FROM tbl_vulnerability WHERE "VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</select>
	<!-- 导出Excel表 -->
	<select id="sqlServervulnerability.export" resultClass="java.util.HashMap"

		parameterClass="java.util.HashMap">
		SELECT * FROM tbl_vulnerability WHERE "VULNERABILITY_IS_DELETE" = 0
		<isNotEmpty prepend="AND" property="ids">
			"VULNERABILITY_ID"
			in($ids$)
		</isNotEmpty>
		
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				("VULNERABILITY_NAME" LIKE '%$keyword$%' OR 

"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$keyword$%' OR "VULNERABILITY_TYPE" LIKE '%

$keyword$%' OR "VULNERABILITY_RISK_FACTOR" LIKE '%$keyword$%' OR "VULNERABILITY_SYNOPSIS"  

LIKE '%$keyword$%') 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityUniqueIdentification">
			<![CDATA[
				"VULNERABILITY_UNIQUE_IDENTIFICATION" LIKE '%$selvulnerabilityUniqueIdentification$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="keyword">
			<![CDATA[
				"VULNERABILITY_NAME" LIKE '%$keyword$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityType">
			<![CDATA[
				"VULNERABILITY_TYPE" LIKE '%$selvulnerabilityType$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilityRiskFactor">
			<![CDATA[
				"VULNERABILITY_RISK_FACTOR" LIKE '%

$selvulnerabilityRiskFactor$%'
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="selvulnerabilitySynopsis">
			<![CDATA[
				"VULNERABILITY_SYNOPSIS" LIKE '%$selvulnerabilitySynopsis$%'
			]]>
		</isNotEmpty>
	</select>

	<!-- 根据漏洞类型查询 -->
	<select id="sqlServervulnerability.queryType" parameterClass="java.lang.String"

		resultMap="vulnerabilityResult">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_TYPE"=#vulnerabilityType#
		]]>
	</select>
	<!-- 根据漏洞类型查询第一条漏洞信息 -->
	<select id="sqlServervulnerability.queryFirstByType" parameterClass="java.lang.String"

		resultMap="vulnerabilityResult">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_TYPE"=#vulnerabilityType# LIMIT 0,1
		]]>
	</select>
	<!-- 根据漏洞类型查询只显示漏洞id,漏洞名 -->
	<select id="sqlServervulnerability.queryByType" parameterClass="java.lang.String"

		resultClass="java.util.HashMap">
		<![CDATA[
			SELECT "VULNERABILITY_ID","VULNERABILITY_NAME","VULNERABILITY_TYPE" 

FROM tbl_vulnerability WHERE "VULNERABILITY_TYPE"=#vulnerabilityType#
		]]>
	</select>
	<select id="sqlServervulnerability.countByType" parameterClass="java.lang.String"

		resultClass="int">
		SELECT COUNT(*) FROM tbl_vulnerability WHERE

		VULNERABILITY_TYPE=#vulnerabilityType#
	</select>
	<!--添加漏洞 -->
	<insert id="sqlServervulnerability.insert" parameterClass="java.util.HashMap">
		INSERT INTO
		"tbl_vulnerability"
		(
		"VULNERABILITY_UNIQUE_IDENTIFICATION",
		"VULNERABILITY_NAME",
		"VULNERABILITY_SYNOPSIS",
		"VULNERABILITY_SOLUTION",
		"VULNERABILITY_SEE_ALSO",
		"VULNERABILITY_TYPE",
		"VULNERABILITY_RISK_FACTOR",
		"VULNERABILITY_UPDATE_DATE_TIME",
		"VULNERABILITY_CVSS_MATH",
		"VULNERABILITY_CVE_ID",
		"VULNERABILITY_PLUGIN_PUBLICATION_DATE_TIME",
		"VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME",
		"VULNERABILITY_ATTACK",
		"VULNERABILITY_PORT",
		"VULNERABILITY_SERVICE",
		"VULNERABILITY_MEMO",
		"VULNERABILITY_OID",
		"VULNERABILITY_VERSION",
		"VULNERABILITY_COPYRIGHT",
		"VULNERABILITY_TAG",
		"VULNERABILITY_DEPENDENCIES",
		"VULNERABILITY_REQUIRED_KEYS",
		"VULNERABILITY_MANDATORG_KEYS",
		"VULNERABILITY_EXCLUED_KEYS",
		"VULNERABILITY_SIGN_KEY_IDS",
		"VULNERABILITY_ASC",
		"VULNERABILITY_NVTI_SRC",
		"VULNERABILITY_CHECK_TYPE",
		"VULNERABILITY_CVSS_BASE",
		"VULNERABILITY_PREFS",
		"VULNERABILITY_TIMEOUT",
		"VULNERABILITY_ASC_FILENAME"
		)
		VALUES(
		#vulnerabilityUniqueIdentification#,
		#vulnerabilityName#,
		#vulnerabilitySynopsis#,
		#vulnerabilitySolution#,
		#vulnerabilitySeeAlso#,
		#vulnerabilityType#,
		#vulnerabilityRiskFactor#,
		#vulnerabilityUpdateDateTime#,
		#vulnerabilityCvssMath#,
		#vulnerabilityCveID#,
		#vulnerabilityPluginPublicationDateTime#,
		#vulnerabilityPluginLastModificationDateTime#,
		#vulnerabilityAttack#,
		#vulnerabilityPort#,
		#vulnerabilityService#,
		#vulnerabilityMemo#,
		#vulnerabilityOid#,
		#vulnerabilityVersion#,
		#vulnerabilityCopyright#,
		#vulnerabilityTag#,
		#vulnerabilityDependencies#,
		#vulnerabilityRequiredKeys#,
		#vulnerabilityMandatorgKeys#,
		#vulnerabilityExcluedKeys#,
		#vulnerabilitySignKeyIds#,
		#vulnerabilityAsc#,
		#vulnerabilityNvtiSrc#,
		#vulnerabilityCheckType#,
		#vulnerabilityCvssBase#,
		#vulnerabilityPrefs#,
		#vulnerabilityTimeout#,
		#vulnerabilityAscFileName#
		)
	</insert>

	<!-- 更新 -->
	<update id="sqlServervulnerability.update" parameterClass="vulnerability">
		UPDATE
		tbl_vulnerability
		SET
		"VULNERABILITY_UNIQUE_IDENTIFICATION" =

		#vulnerabilityUniqueIdentification#,
		"VULNERABILITY_NAME" =
		#vulnerabilityName#,
		"VULNERABILITY_SYNOPSIS" = #vulnerabilitySynopsis#,
		"VULNERABILITY_SOLUTION" = #vulnerabilitySolution#,
		"VULNERABILITY_SEE_ALSO" = #vulnerabilitySeeAlso#,
		"VULNERABILITY_TYPE" =
		#vulnerabilityType#,
		"VULNERABILITY_RISK_FACTOR" =

		#vulnerabilityRiskFactor#,
		"VULNERABILITY_UPDATE_DATE_TIME" =

		#vulnerabilityUpdateDateTime#,
		"VULNERABILITY_CVSS_MATH" =
		#vulnerabilityCvssMath#,
		"VULNERABILITY_CVE_ID"=#vulnerabilityCveID#,
		"VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" =

		#vulnerabilityPluginLastModificationDateTime#,
		"VULNERABILITY_ATTACK" =
		#vulnerabilityAttack#,
		"VULNERABILITY_PORT" = #vulnerabilityPort#,
		"VULNERABILITY_SERVICE" = #vulnerabilityService#,
		"VULNERABILITY_MEMO" =
		#vulnerabilityMemo#

		WHERE
		"VULNERABILITY_ID" = #vulnerabilityId#
	</update>
	<!-- 标记删除 -->
	<delete id="sqlServervulnerability.delete" parameterClass="long">
		<![CDATA[
			UPDATE tbl_vulnerability SET "VULNERABILITY_IS_DELETE" = 1 WHERE 

"VULNERABILITY_ID"=#vulnerabilityId#
		]]>
	</delete>

	<!--清空漏洞信息表 -->
	<delete id="sqlServervulnerability.delete2" parameterClass="long">
		<![CDATA[
		DELETE  from tbl_vulnerability
		]]>
	</delete>

	<!-- 根据漏洞编号查询 -->
	<select id="sqlServervulnerability.queryVulnerabilityUniqueIdentification"

		parameterClass="java.lang.String" resultClass="vulnerability">
		<![CDATA[
			SELECT * FROM tbl_vulnerability WHERE 

"VULNERABILITY_UNIQUE_IDENTIFICATION"=#vulnerabilityUniqueIdentification#
		]]>
	</select>

	<!-- 查询所有的漏洞编号 -->
	<select id="sqlServervulnerability.queryAllIdentification" resultMap="vulnerabilityResult1">
		SELECT "VULNERABILITY_UNIQUE_IDENTIFICATION" from tbl_vulnerability
	</select>

	<!-- 查询所有漏洞类型 -->
	<select id="sqlServervulnerability.queryVulnerabilityType" resultMap="vulnerabilityResult2">
	  <![CDATA[
	     SELECT "VULNERABILITY_TYPE" FROM tbl_vulnerability GROUP BY  

"VULNERABILITY_TYPE" 
	  ]]>
	</select>

	<!-- 漏洞信息导入 -->
	<insert id="sqlServervulnerability.importVulnerability" parameterClass="vulnerability">
	  <![CDATA[
	   INSERT INTO tbl_vulnerability
	   (
	              "VULNERABILITY_UNIQUE_IDENTIFICATION",
					"VULNERABILITY_NAME",
					"VULNERABILITY_SYNOPSIS",
					"VULNERABILITY_SOLUTION",
					"VULNERABILITY_SEE_ALSO", 
					"VULNERABILITY_TYPE",
					"VULNERABILITY_RISK_FACTOR",
					"VULNERABILITY_UPDATE_DATE_TIME",
					"VULNERABILITY_CVSS_MATH",
					"VULNERABILITY_CVE_ID",
					"VULNERABILITY_PLUGIN_PUBLICATION_DATE_TIME",
					"VULNERABILITY_ATTACK",
					"VULNERABILITY_PORT",
					"VULNERABILITY_SERVICE",
					"VULNERABILITY_MEMO",
					"VULNERABILITY_OID",
					"VULNERABILITY_VERSION",
					"VULNERABILITY_COPYRIGHT",
					"VULNERABILITY_TAG",
					"VULNERABILITY_DEPENDENCIES",
					"VULNERABILITY_REQUIRED_KEYS",
					"VULNERABILITY_MANDATORG_KEYS",
					"VULNERABILITY_EXCLUED_KEYS",
					"VULNERABILITY_SIGN_KEY_IDS",
					"VULNERABILITY_ASC",
					"VULNERABILITY_NVTI_SRC",
					"VULNERABILITY_CHECK_TYPE",
					"VULNERABILITY_CVSS_BASE",
					"VULNERABILITY_PREFS", 
					"VULNERABILITY_TIMEOUT",
					"VULNERABILITY_ASC_FILENAME"
	   )
	   VALUES(
	                #vulnerabilityUniqueIdentification#,
				    #vulnerabilityName#,
				    #vulnerabilitySynopsis#,
				    #vulnerabilitySolution#,
				    #vulnerabilitySeeAlso#,
				    #vulnerabilityType#,
				    #vulnerabilityRiskFactor#,
				    #vulnerabilityUpdateDateTime#,
				    #vulnerabilityCvssMath#,
				    #vulnerabilityCveID#,
				    #vulnerabilityPluginPublicationDateTime#,
				    #vulnerabilityAttack#,
				    #vulnerabilityPort#,
				    #vulnerabilityService#,
				    #vulnerabilityMemo#,
				    #vulnerabilityOid#,
				    #vulnerabilityVersion#,
				    #vulnerabilityCopyright#,
				    #vulnerabilityTag#,
				    #vulnerabilityDependencies#,
				    #vulnerabilityRequiredKeys#,
				    #vulnerabilityMandatorgKeys#,
				    #vulnerabilityExcluedKeys#,
				    #vulnerabilitySignKeyIds#,
				    #vulnerabilityAsc#,
				    #vulnerabilityNvtiSrc#,
				    #vulnerabilityCheckType#,
				    #vulnerabilityCvssBase#,
				    #vulnerabilityPrefs#,
				    #vulnerabilityTimeout#,
				    #vulnerabilityAscFileName#
	   )  
	  ]]>
	</insert>

	<!--漏洞导入修改 -->
	<update id="sqlServervulnerability.updateimport" parameterClass="vulnerability">
		UPDATE
		tbl_vulnerability 
		SET
		"VULNERABILITY_NAME" = #vulnerabilityName#,
		"VULNERABILITY_SYNOPSIS" = #vulnerabilitySynopsis#,
		"VULNERABILITY_SOLUTION" = #vulnerabilitySolution#,
		"VULNERABILITY_SEE_ALSO" = #vulnerabilitySeeAlso#,
		"VULNERABILITY_TYPE" =
		#vulnerabilityType#,
		"VULNERABILITY_RISK_FACTOR" =

		#vulnerabilityRiskFactor#,
		"VULNERABILITY_UPDATE_DATE_TIME" =

		#vulnerabilityUpdateDateTime#,
		"VULNERABILITY_CVSS_MATH" =
		#vulnerabilityCvssMath#,
		"VULNERABILITY_CVE_ID"=#vulnerabilityCveID#,
		"VULNERABILITY_PLUGIN_LAST_MODIFICATION_DATE_TIME" =
#vulnerabilityPluginLastModificationDateTime#,
		"VULNERABILITY_ATTACK" =
		#vulnerabilityAttack#,
		"VULNERABILITY_PORT" = #vulnerabilityPort#,
		"VULNERABILITY_SERVICE" = #vulnerabilityService#,
		"VULNERABILITY_IS_DELETE"= #vulnerabilityIsDelete#,
		"VULNERABILITY_MEMO" =
		#vulnerabilityMemo#,
		"VULNERABILITY_OID" = #vulnerabilityOid#,
		"VULNERABILITY_VERSION" = #vulnerabilityVersion#,
		"VULNERABILITY_COPYRIGHT" = #vulnerabilityCopyright#,
		"VULNERABILITY_TAG" =
		#vulnerabilityTag#,
		"VULNERABILITY_DEPENDENCIES" =

		#vulnerabilityDependencies#,
		"VULNERABILITY_REQUIRED_KEYS" =

		#vulnerabilityRequiredKeys#,
		"VULNERABILITY_MANDATORG_KEYS" =

		#vulnerabilityMandatorgKeys#,
		"VULNERABILITY_EXCLUED_KEYS" =

		#vulnerabilityExcluedKeys#,
		"VULNERABILITY_SIGN_KEY_IDS" =

		#vulnerabilitySignKeyIds#,
		"VULNERABILITY_ASC" = #vulnerabilityAsc#,
		"VULNERABILITY_NVTI_SRC" = #vulnerabilityNvtiSrc#,
		"VULNERABILITY_CHECK_TYPE" = #vulnerabilityCheckType#,
		"VULNERABILITY_CVSS_BASE" = #vulnerabilityCvssBase#,
		"VULNERABILITY_PREFS"
		= #vulnerabilityPrefs#,
		"VULNERABILITY_TIMEOUT" = #vulnerabilityTimeout#,
		"VULNERABILITY_ASC_FILENAME" =

		#vulnerabilityAscFileName#
		WHERE
		"VULNERABILITY_UNIQUE_IDENTIFICATION" =

		#vulnerabilityUniqueIdentification#

	</update>
	<!-- 排序 -->
<select id="sqlServervulnerability.sort" resultMap="vulnerabilityResult" parameterClass="java.lang.String">
      SELECT * FROM tbl_vulnerability ORDER BY $str$
</select>
</sqlMap>
